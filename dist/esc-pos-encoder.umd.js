!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs"),require("events"),require("util"),require("path"),require("assert"),require("http"),require("https"),require("querystring"),require("url")):"function"==typeof define&&define.amd?define(["fs","events","util","path","assert","http","https","querystring","url"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).EscPosEncoder=e(t.require$$0,t.require$$3,t.require$$3$2,t.require$$4,t.require$$5,t.require$$2,t.require$$3$1,t.require$$5$1,t.require$$6)}(this,(function(t,e,r,i,s,n,a,o,h){"use strict";var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function u(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){if(this instanceof t){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(e,r))}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),r}var p={exports:{}},f={html:{skipScheme:"html",lineBreakScheme:"html",whitespace:"collapse"}},d=/<\s*br(?:[\s/]*|\s[^>]*)>/gi,g={unix:[/\n/g,"\n"],dos:[/\r\n/g,"\r\n"],mac:[/\r/g,"\r"],html:[d,"<br>"],xhtml:[d,"<br/>"]},m={"ansi-color":/\x1B\[[^m]*m/g,html:/<[^>]*>/g,bbcode:/\[[^]]*\]/g},w={soft:1,hard:1},y={collapse:1,default:1,line:1,all:1},b={all:1,multi:1,none:1},v=/([sm])(\d+)/,_=/[-/\\^$*+?.()|[\]{}]/g;function x(t){return t.replace(_,"\\$&")}var k=p.exports=function(t,e,r){"object"==typeof t&&(t=(r=t).start,e=r.stop),"object"==typeof e&&(r=e,t=t||r.start,e=void 0),e||(e=t,t=0),r||(r={});var i,s,n,a,o,h,c,l,u,p,d,_,k,E,A,j,O,S,C="soft",I="default",T=4,M="all",L="",N="";if(i=r.preset)for(i instanceof Array||(i=[i]),S=0;S<i.length;S++){if(!(j=f[i[S]]))throw new TypeError('preset must be one of "'+Object.keys(f).join('", "')+'"');j.mode&&(C=j.mode),j.whitespace&&(I=j.whitespace),void 0!==j.tabWidth&&(T=j.tabWidth),j.skip&&(s=j.skip),j.skipScheme&&(n=j.skipScheme),j.lineBreak&&(a=j.lineBreak),j.lineBreakScheme&&(o=j.lineBreakScheme),j.respectLineBreaks&&(M=j.respectLineBreaks),void 0!==j.preservedLineIndent&&(c=j.preservedLineIndent),void 0!==j.wrapLineIndent&&(l=j.wrapLineIndent),j.wrapLineIndentBase&&(u=j.wrapLineIndentBase)}if(r.mode){if(!w[r.mode])throw new TypeError('mode must be one of "'+Object.keys(w).join('", "')+'"');C=r.mode}if(r.whitespace){if(!y[r.whitespace])throw new TypeError('whitespace must be one of "'+Object.keys(y).join('", "')+'"');I=r.whitespace}if(void 0!==r.tabWidth){if(!(parseInt(r.tabWidth,10)>=0))throw new TypeError("tabWidth must be a non-negative integer");T=parseInt(r.tabWidth,10)}if(A=new Array(T+1).join(" "),r.respectLineBreaks){if(!b[r.respectLineBreaks]&&!v.test(r.respectLineBreaks))throw new TypeError('respectLineBreaks must be one of "'+Object.keys(b).join('", "')+'", "m<num>", "s<num>"');M=r.respectLineBreaks}if("multi"===M)M="m",h=2;else if(!b[M]){var R=v.exec(M);M=R[1],h=parseInt(R[2],10)}if(void 0!==r.preservedLineIndent){if(!(parseInt(r.preservedLineIndent,10)>=0))throw new TypeError("preservedLineIndent must be a non-negative integer");c=parseInt(r.preservedLineIndent,10)}if(c>0&&(L=new Array(c+1).join(" ")),void 0!==r.wrapLineIndent){if(isNaN(parseInt(r.wrapLineIndent,10)))throw new TypeError("wrapLineIndent must be an integer");l=parseInt(r.wrapLineIndent,10)}if(r.wrapLineIndentBase&&(u=r.wrapLineIndentBase),u){if(void 0===l)throw new TypeError("wrapLineIndent must be specified when wrapLineIndentBase is specified");if(u instanceof RegExp)E=u;else{if("string"!=typeof u)throw new TypeError("wrapLineIndentBase must be either a RegExp object or a string");E=new RegExp(x(u))}}else if(l>0)N=new Array(l+1).join(" ");else if(l<0)throw new TypeError("wrapLineIndent must be non-negative when a base is not specified");if(r.skipScheme){if(!m[r.skipScheme])throw new TypeError('skipScheme must be one of "'+Object.keys(m).join('", "')+'"');n=r.skipScheme}if(r.skip&&(s=r.skip),s)if(s instanceof RegExp)(p=s).global||(O="g",p.ignoreCase&&(O+="i"),p.multiline&&(O+="m"),p=new RegExp(p.source,O));else{if("string"!=typeof s)throw new TypeError("skip must be either a RegExp object or a string");p=new RegExp(x(s),"g")}if(!p&&n&&(p=m[n]),r.lineBreakScheme){if(!g[r.lineBreakScheme])throw new TypeError('lineBreakScheme must be one of "'+Object.keys(g).join('", "')+'"');o=r.lineBreakScheme}if(r.lineBreak&&(a=r.lineBreak),o&&(j=g[o])&&(d=j[0],_=j[1]),a)if(a instanceof Array&&(1===a.length?a=a[0]:a.length>=2&&(a[0]instanceof RegExp?(d=a[0],"string"==typeof a[1]&&(_=a[1])):a[1]instanceof RegExp?(d=a[1],"string"==typeof a[0]&&(_=a[0])):"string"==typeof a[0]&&"string"==typeof a[1]?(d=new RegExp(x(a[0]),"g"),_=a[1]):a=a[0])),"string"==typeof a)_=a,d||(d=new RegExp(x(a),"g"));else if(a instanceof RegExp)d=a;else if(!(a instanceof Array))throw new TypeError("lineBreak must be a RegExp object, a string, or an array consisted of a RegExp object and a string");d||(d=/\n/g,_="\n"),O="g",d.ignoreCase&&(O+="i"),d.multiline&&(O+="m"),k=new RegExp("\\s*(?:"+d.source+")(?:"+d.source+"|\\s)*",O),d.global||(d=new RegExp(d.source,O));var $="hard"===C?/\b/:/(\S+\s+)/,q=new Array(t+1).join(" "),D="default"===I||"collapse"===I,B="collapse"===I,P="line"===I,z="all"===I,F=/\t/g,U=/  +/g,W=/^\s+/,G=/\s+$/,Q=/\S/,H=/\s/,J=e-t;return function(r){var i;if(r=r.toString().replace(F,A),!_){if(d.lastIndex=0,!(i=d.exec(r)))throw new TypeError("Line break string for the output not specified");_=i[0]}var s,n,a,o,c,u,f,g,m,w=0;for(s=[],k.lastIndex=0,i=k.exec(r);i;){if(s.push(r.substring(w,i.index)),"none"!==M){for(a=[],o=0,d.lastIndex=0,n=d.exec(i[0]);n;)a.push(i[0].substring(o,n.index)),o=n.index+n[0].length,n=d.exec(i[0]);a.push(i[0].substring(o)),s.push({type:"break",breaks:a})}else c=B?" ":i[0].replace(d,""),s.push({type:"break",remaining:c});w=i.index+i[0].length,i=k.exec(r)}if(s.push(r.substring(w)),p)for(m=[],u=0;u<s.length;u++){var y=s[u];if("string"!=typeof y)m.push(y);else{for(w=0,p.lastIndex=0,i=p.exec(y);i;)m.push(y.substring(w,i.index)),m.push({type:"skip",value:i[0]}),w=i.index+i[0].length,i=p.exec(y);m.push(y.substring(w))}}else m=s;var b=[];for(u=0;u<m.length;u++){var v=m[u];if("string"!=typeof v)b.push(v);else{B&&(v=v.replace(U," "));var x=v.split($),j=[];for(f=0;f<x.length;f++){var O=x[f];if("hard"===C)for(g=0;g<O.length;g+=J)j.push(O.slice(g,g+J));else j.push(O)}b=b.concat(j)}}var S,I=0,T=t+L.length,R=[q+L],K=0,V=!0,Y=!0,X=N;function Z(r){var i,s,n,a=R[I];if(z)T>e&&(K=K||e,n=a.length-(T-K),R[I]=a.substring(0,n)),K=0;else{for(i=a.length-1;i>=t&&" "===a[i];)i--;for(;i>=t&&H.test(a[i]);)i--;++i!==a.length&&(R[I]=a.substring(0,i)),Y&&V&&P&&T>e&&(n=a.length-(T-e))<i&&(n=i)}if(Y&&(Y=!1,E&&(i=R[I].substring(t).search(E),X=i>=0&&i+l>0?new Array(i+l+1).join(" "):"")),n){for(;n+J<a.length;)z?(s=a.substring(n,n+J),R.push(q+X+s)):R.push(q+X),n+=J,I++;if(!r)return s=a.substring(n),X+s;z?(s=a.substring(n),R.push(q+X+s)):R.push(q+X),I++}return""}for(u=0;u<b.length;u++){var tt=b[u];if(""!==tt)if("string"==typeof tt){for(var et;;){if(et=void 0,T+tt.length>e&&T+(et=tt.replace(G,"")).length>e&&""!==et&&T>t){if(S=Z(!1),R.push(q+X),I++,T=t+X.length,S){R[I]+=S,T+=S.length,V=!0;continue}!D&&(!P||Y&&V)||(tt=tt.replace(W,"")),V=!1}else V&&(D||P&&(!Y||!V)?""!==(tt=tt.replace(W,""))&&(V=!1):Q.test(tt)&&(V=!1));break}z&&et&&T+et.length>e&&(K=T+et.length),R[I]+=tt,T+=tt.length}else if("break"===tt.type)if("none"!==M){var rt=tt.breaks,it=rt.length-1;if("s"===M){for(f=0;f<it;f++)rt[f+1].length<h?rt[f+1]=B?" ":rt[f]+rt[f+1]:(z&&(R[I]+=rt[f],T+=rt[f].length),Z(!0),R.push(q+L),I++,T=t+L.length,Y=V=!0);(!V||z||P&&Y)&&((B||!V&&""===rt[it])&&(rt[it]=" "),R[I]+=rt[it],T+=rt[it].length)}else if("m"===M&&it<h)(!V||z||P&&Y)&&(B?tt=" ":(tt=rt.join(""),V||""!==tt||(tt=" ")),R[I]+=tt,T+=tt.length);else if(D){for(Z(!0),f=0;f<it;f++)R.push(q+L),I++;T=t+L.length,Y=V=!0}else for((z||Y&&V)&&(R[I]+=rt[0],T+=rt[0].length),f=0;f<it;f++)Z(!0),R.push(q+L+rt[f+1]),I++,T=t+L.length+rt[f+1].length,Y=V=!0}else(!V||z||P&&Y)&&(tt=tt.remaining,(B||!V&&""===tt)&&(tt=" "),R[I]+=tt,T+=tt.length);else"skip"===tt.type&&(T>e&&(S=Z(!1),R.push(q+X),I++,T=t+X.length,S&&(R[I]+=S,T+=S.length),V=!0),R[I]+=tt.value)}return Z(!0),R.join(_)}};k.soft=k,k.hard=function(){var t=[].slice.call(arguments),e=t.length-1;return"object"==typeof t[e]?t[e].mode="hard":t.push({mode:"hard"}),k.apply(null,t)},k.wrap=function(t){var e=[].slice.call(arguments);return e.shift(),k.apply(null,e)(t)};var E=l(p.exports),A={},j=i,O="win32"===process.platform,S=t,C=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function I(t){return"function"==typeof t?t:function(){var t;if(C){var e=new Error;t=function(t){t&&(e.message=t.message,r(t=e))}}else t=r;return t;function r(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}()}if(j.normalize,O)var T=/(.*?)(?:[\/\\]+|$)/g;else T=/(.*?)(?:[\/]+|$)/g;if(O)var M=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else M=/^[\/]*/;A.realpathSync=function(t,e){if(t=j.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var r,i,s,n,a=t,o={},h={};function c(){var e=M.exec(t);r=e[0].length,i=e[0],s=e[0],n="",O&&!h[s]&&(S.lstatSync(s),h[s]=!0)}for(c();r<t.length;){T.lastIndex=r;var l=T.exec(t);if(n=i,i+=l[0],s=n+l[1],r=T.lastIndex,!(h[s]||e&&e[s]===s)){var u;if(e&&Object.prototype.hasOwnProperty.call(e,s))u=e[s];else{var p=S.lstatSync(s);if(!p.isSymbolicLink()){h[s]=!0,e&&(e[s]=s);continue}var f=null;if(!O){var d=p.dev.toString(32)+":"+p.ino.toString(32);o.hasOwnProperty(d)&&(f=o[d])}null===f&&(S.statSync(s),f=S.readlinkSync(s)),u=j.resolve(n,f),e&&(e[s]=u),O||(o[d]=f)}t=j.resolve(u,t.slice(r)),c()}}return e&&(e[a]=t),t},A.realpath=function(t,e,r){if("function"!=typeof r&&(r=I(e),e=null),t=j.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(r.bind(null,null,e[t]));var i,s,n,a,o=t,h={},c={};function l(){var e=M.exec(t);i=e[0].length,s=e[0],n=e[0],a="",O&&!c[n]?S.lstat(n,(function(t){if(t)return r(t);c[n]=!0,u()})):process.nextTick(u)}function u(){if(i>=t.length)return e&&(e[o]=t),r(null,t);T.lastIndex=i;var h=T.exec(t);return a=s,s+=h[0],n=a+h[1],i=T.lastIndex,c[n]||e&&e[n]===n?process.nextTick(u):e&&Object.prototype.hasOwnProperty.call(e,n)?d(e[n]):S.lstat(n,p)}function p(t,i){if(t)return r(t);if(!i.isSymbolicLink())return c[n]=!0,e&&(e[n]=n),process.nextTick(u);if(!O){var s=i.dev.toString(32)+":"+i.ino.toString(32);if(h.hasOwnProperty(s))return f(null,h[s],n)}S.stat(n,(function(t){if(t)return r(t);S.readlink(n,(function(t,e){O||(h[s]=e),f(t,e)}))}))}function f(t,i,s){if(t)return r(t);var n=j.resolve(a,i);e&&(e[s]=n),d(n)}function d(e){t=j.resolve(e,t.slice(i)),l()}l()};var L=z;z.realpath=z,z.sync=F,z.realpathSync=F,z.monkeypatch=function(){N.realpath=z,N.realpathSync=F},z.unmonkeypatch=function(){N.realpath=R,N.realpathSync=$};var N=t,R=N.realpath,$=N.realpathSync,q=process.version,D=/^v[0-5]\./.test(q),B=A;function P(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function z(t,e,r){if(D)return R(t,e,r);"function"==typeof e&&(r=e,e=null),R(t,e,(function(i,s){P(i)?B.realpath(t,e,r):r(i,s)}))}function F(t,e){if(D)return $(t,e);try{return $(t,e)}catch(r){if(P(r))return B.realpathSync(t,e);throw r}}var U="object"==typeof process&&process&&"win32"===process.platform?{sep:"\\"}:{sep:"/"},W=G;function G(t,e,r){t instanceof RegExp&&(t=Q(t,r)),e instanceof RegExp&&(e=Q(e,r));var i=H(t,e,r);return i&&{start:i[0],end:i[1],pre:r.slice(0,i[0]),body:r.slice(i[0]+t.length,i[1]),post:r.slice(i[1]+e.length)}}function Q(t,e){var r=e.match(t);return r?r[0]:null}function H(t,e,r){var i,s,n,a,o,h=r.indexOf(t),c=r.indexOf(e,h+1),l=h;if(h>=0&&c>0){if(t===e)return[h,c];for(i=[],n=r.length;l>=0&&!o;)l==h?(i.push(l),h=r.indexOf(t,l+1)):1==i.length?o=[i.pop(),c]:((s=i.pop())<n&&(n=s,a=c),c=r.indexOf(e,l+1)),l=h<c&&h>=0?h:c;i.length&&(o=[n,a])}return o}G.range=H;var J=W,K=function(t){if(!t)return[];"{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2));return ht(function(t){return t.split("\\\\").join(V).split("\\{").join(Y).split("\\}").join(X).split("\\,").join(Z).split("\\.").join(tt)}(t),!0).map(rt)},V="\0SLASH"+Math.random()+"\0",Y="\0OPEN"+Math.random()+"\0",X="\0CLOSE"+Math.random()+"\0",Z="\0COMMA"+Math.random()+"\0",tt="\0PERIOD"+Math.random()+"\0";function et(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function rt(t){return t.split(V).join("\\").split(Y).join("{").split(X).join("}").split(Z).join(",").split(tt).join(".")}function it(t){if(!t)return[""];var e=[],r=J("{","}",t);if(!r)return t.split(",");var i=r.pre,s=r.body,n=r.post,a=i.split(",");a[a.length-1]+="{"+s+"}";var o=it(n);return n.length&&(a[a.length-1]+=o.shift(),a.push.apply(a,o)),e.push.apply(e,a),e}function st(t){return"{"+t+"}"}function nt(t){return/^-?0\d/.test(t)}function at(t,e){return t<=e}function ot(t,e){return t>=e}function ht(t,e){var r=[],i=J("{","}",t);if(!i)return[t];var s=i.pre,n=i.post.length?ht(i.post,!1):[""];if(/\$$/.test(i.pre))for(var a=0;a<n.length;a++){var o=s+"{"+i.body+"}"+n[a];r.push(o)}else{var h,c,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),p=l||u,f=i.body.indexOf(",")>=0;if(!p&&!f)return i.post.match(/,.*\}/)?ht(t=i.pre+"{"+i.body+X+i.post):[t];if(p)h=i.body.split(/\.\./);else if(1===(h=it(i.body)).length&&1===(h=ht(h[0],!1).map(st)).length)return n.map((function(t){return i.pre+h[0]+t}));if(p){var d=et(h[0]),g=et(h[1]),m=Math.max(h[0].length,h[1].length),w=3==h.length?Math.abs(et(h[2])):1,y=at;g<d&&(w*=-1,y=ot);var b=h.some(nt);c=[];for(var v=d;y(v,g);v+=w){var _;if(u)"\\"===(_=String.fromCharCode(v))&&(_="");else if(_=String(v),b){var x=m-_.length;if(x>0){var k=new Array(x+1).join("0");_=v<0?"-"+k+_.slice(1):k+_}}c.push(_)}}else{c=[];for(var E=0;E<h.length;E++)c.push.apply(c,ht(h[E],!1))}for(E=0;E<c.length;E++)for(a=0;a<n.length;a++){o=s+c[E]+n[a];(!e||p||o)&&r.push(o)}}return r}const ct=lt=(t,e,r={})=>(kt(e),!(!r.nocomment&&"#"===e.charAt(0))&&new jt(e,r).match(t));var lt=ct;const ut=U;ct.sep=ut.sep;const pt=Symbol("globstar **");ct.GLOBSTAR=pt;const ft=K,dt={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},gt="[^/]",mt=gt+"*?",wt=t=>t.split("").reduce(((t,e)=>(t[e]=!0,t)),{}),yt=wt("().*{}+?[]^$\\!"),bt=wt("[.("),vt=/\/+/;ct.filter=(t,e={})=>(r,i,s)=>ct(r,t,e);const _t=(t,e={})=>{const r={};return Object.keys(t).forEach((e=>r[e]=t[e])),Object.keys(e).forEach((t=>r[t]=e[t])),r};ct.defaults=t=>{if(!t||"object"!=typeof t||!Object.keys(t).length)return ct;const e=ct,r=(r,i,s)=>e(r,i,_t(t,s));return r.Minimatch=class extends e.Minimatch{constructor(e,r){super(e,_t(t,r))}},r.Minimatch.defaults=r=>e.defaults(_t(t,r)).Minimatch,r.filter=(r,i)=>e.filter(r,_t(t,i)),r.defaults=r=>e.defaults(_t(t,r)),r.makeRe=(r,i)=>e.makeRe(r,_t(t,i)),r.braceExpand=(r,i)=>e.braceExpand(r,_t(t,i)),r.match=(r,i,s)=>e.match(r,i,_t(t,s)),r},ct.braceExpand=(t,e)=>xt(t,e);const xt=(t,e={})=>(kt(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:ft(t)),kt=t=>{if("string"!=typeof t)throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")},Et=Symbol("subparse");ct.makeRe=(t,e)=>new jt(t,e||{}).makeRe(),ct.match=(t,e,r={})=>{const i=new jt(e,r);return t=t.filter((t=>i.match(t))),i.options.nonull&&!t.length&&t.push(e),t};const At=t=>t.replace(/[[\]\\]/g,"\\$&");let jt=class{constructor(t,e){kt(t),e||(e={}),this.options=e,this.set=[],this.pattern=t,this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||!1===e.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}debug(){}make(){const t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();let r=this.globSet=this.braceExpand();e.debug&&(this.debug=(...t)=>console.error(...t)),this.debug(this.pattern,r),r=this.globParts=r.map((t=>t.split(vt))),this.debug(this.pattern,r),r=r.map(((t,e,r)=>t.map(this.parse,this))),this.debug(this.pattern,r),r=r.filter((t=>-1===t.indexOf(!1))),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;const t=this.pattern;let e=!1,r=0;for(let i=0;i<t.length&&"!"===t.charAt(i);i++)e=!e,r++;r&&(this.pattern=t.slice(r)),this.negate=e}matchOne(t,e,r){var i=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var s=0,n=0,a=t.length,o=e.length;s<a&&n<o;s++,n++){this.debug("matchOne loop");var h,c=e[n],l=t[s];if(this.debug(e,c,l),!1===c)return!1;if(c===pt){this.debug("GLOBSTAR",[e,c,l]);var u=s,p=n+1;if(p===o){for(this.debug("** at the end");s<a;s++)if("."===t[s]||".."===t[s]||!i.dot&&"."===t[s].charAt(0))return!1;return!0}for(;u<a;){var f=t[u];if(this.debug("\nglobstar while",t,u,e,p,f),this.matchOne(t.slice(u),e.slice(p),r))return this.debug("globstar found match!",u,a,f),!0;if("."===f||".."===f||!i.dot&&"."===f.charAt(0)){this.debug("dot detected!",t,u,e,p);break}this.debug("globstar swallow a segment, and continue"),u++}return!(!r||(this.debug("\n>>> no match, partial?",t,u,e,p),u!==a))}if("string"==typeof c?(h=l===c,this.debug("string match",c,l,h)):(h=l.match(c),this.debug("pattern match",c,l,h)),!h)return!1}if(s===a&&n===o)return!0;if(s===a)return r;if(n===o)return s===a-1&&""===t[s];throw new Error("wtf?")}braceExpand(){return xt(this.pattern,this.options)}parse(t,e){kt(t);const r=this.options;if("**"===t){if(!r.noglobstar)return pt;t="*"}if(""===t)return"";let i="",s=!1,n=!1;const a=[],o=[];let h,c,l,u,p=!1,f=-1,d=-1,g="."===t.charAt(0),m=r.dot||g;const w=t=>"."===t.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",y=()=>{if(h){switch(h){case"*":i+=mt,s=!0;break;case"?":i+=gt,s=!0;break;default:i+="\\"+h}this.debug("clearStateChar %j %j",h,i),h=!1}};for(let e,u=0;u<t.length&&(e=t.charAt(u));u++)if(this.debug("%s\t%s %s %j",t,u,i,e),n){if("/"===e)return!1;yt[e]&&(i+="\\"),i+=e,n=!1}else switch(e){case"/":return!1;case"\\":if(p&&"-"===t.charAt(u+1)){i+=e;continue}y(),n=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,u,i,e),p){this.debug("  in class"),"!"===e&&u===d+1&&(e="^"),i+=e;continue}this.debug("call clearStateChar %j",h),y(),h=e,r.noext&&y();continue;case"(":{if(p){i+="(";continue}if(!h){i+="\\(";continue}const e={type:h,start:u-1,reStart:i.length,open:dt[h].open,close:dt[h].close};this.debug(this.pattern,"\t",e),a.push(e),i+=e.open,0===e.start&&"!"!==e.type&&(g=!0,i+=w(t.slice(u+1))),this.debug("plType %j %j",h,i),h=!1;continue}case")":{const t=a[a.length-1];if(p||!t){i+="\\)";continue}a.pop(),y(),s=!0,l=t,i+=l.close,"!"===l.type&&o.push(Object.assign(l,{reEnd:i.length}));continue}case"|":{const e=a[a.length-1];if(p||!e){i+="\\|";continue}y(),i+="|",0===e.start&&"!"!==e.type&&(g=!0,i+=w(t.slice(u+1)));continue}case"[":if(y(),p){i+="\\"+e;continue}p=!0,d=u,f=i.length,i+=e;continue;case"]":if(u===d+1||!p){i+="\\"+e;continue}c=t.substring(d+1,u);try{RegExp("["+At(c.replace(/\\([^-\]])/g,"$1"))+"]"),i+=e}catch(t){i=i.substring(0,f)+"(?:$.)"}s=!0,p=!1;continue;default:y(),!yt[e]||"^"===e&&p||(i+="\\"),i+=e}for(p&&(c=t.slice(d+1),u=this.parse(c,Et),i=i.substring(0,f)+"\\["+u[0],s=s||u[1]),l=a.pop();l;l=a.pop()){let t;t=i.slice(l.reStart+l.open.length),this.debug("setting tail",i,l),t=t.replace(/((?:\\{2}){0,64})(\\?)\|/g,((t,e,r)=>(r||(r="\\"),e+e+r+"|"))),this.debug("tail=%j\n   %s",t,t,l,i);const e="*"===l.type?mt:"?"===l.type?gt:"\\"+l.type;s=!0,i=i.slice(0,l.reStart)+e+"\\("+t}y(),n&&(i+="\\\\");const b=bt[i.charAt(0)];for(let t=o.length-1;t>-1;t--){const r=o[t],s=i.slice(0,r.reStart),n=i.slice(r.reStart,r.reEnd-8);let a=i.slice(r.reEnd);const h=i.slice(r.reEnd-8,r.reEnd)+a,c=s.split(")").length,l=s.split("(").length-c;let u=a;for(let t=0;t<l;t++)u=u.replace(/\)[+*?]?/,"");a=u;i=s+n+a+(""===a&&e!==Et?"(?:$|\\/)":"")+h}if(""!==i&&s&&(i="(?=.)"+i),b&&(i=(g?"":m?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)")+i),e===Et)return[i,s];if(r.nocase&&!s&&(s=t.toUpperCase()!==t.toLowerCase()),!s)return(t=>t.replace(/\\(.)/g,"$1"))(t);const v=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",v),{_glob:t,_src:i})}catch(t){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const t=this.set;if(!t.length)return this.regexp=!1,this.regexp;const e=this.options,r=e.noglobstar?mt:e.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=e.nocase?"i":"";let s=t.map((t=>(t=t.map((t=>"string"==typeof t?t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):t===pt?pt:t._src)).reduce(((t,e)=>(t[t.length-1]===pt&&e===pt||t.push(e),t)),[]),t.forEach(((e,i)=>{e===pt&&t[i-1]!==pt&&(0===i?t.length>1?t[i+1]="(?:\\/|"+r+"\\/)?"+t[i+1]:t[i]=r:i===t.length-1?t[i-1]+="(?:\\/|"+r+")?":(t[i-1]+="(?:\\/|\\/"+r+"\\/)"+t[i+1],t[i+1]=pt))})),t.filter((t=>t!==pt)).join("/")))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch(t){this.regexp=!1}return this.regexp}match(t,e=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;const r=this.options;"/"!==ut.sep&&(t=t.split(ut.sep).join("/")),t=t.split(vt),this.debug(this.pattern,"split",t);const i=this.set;let s;this.debug(this.pattern,"set",i);for(let e=t.length-1;e>=0&&(s=t[e],!s);e--);for(let n=0;n<i.length;n++){const a=i[n];let o=t;r.matchBase&&1===a.length&&(o=[s]);if(this.matchOne(o,a,e))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}static defaults(t){return ct.defaults(t).Minimatch}};ct.Minimatch=jt;var Ot={exports:{}};"function"==typeof Object.create?Ot.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Ot.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}};var St=Ot.exports,Ct={};function It(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Ct.setopts=function(t,e,r){r||(r={});if(r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.windowsPathsNoEscape=!!r.windowsPathsNoEscape||!1===r.allowWindowsEscape,t.windowsPathsNoEscape&&(e=e.replace(/\\/g,"/"));t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0);t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||Lt,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),function(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]);t.ignore.length&&(t.ignore=t.ignore.map(Bt))}(t,r),t.changedCwd=!1;var i=process.cwd();It(r,"cwd")?(t.cwd=Nt.resolve(r.cwd),t.changedCwd=t.cwd!==i):t.cwd=Nt.resolve(i);t.root=r.root||Nt.resolve(t.cwd,"/"),t.root=Nt.resolve(t.root),t.cwdAbs=$t(t.cwd)?t.cwd:Pt(t,t.cwd),t.nomount=!!r.nomount,"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/"),t.cwd=t.cwd.replace(/\\/g,"/"),t.cwdAbs=t.cwdAbs.replace(/\\/g,"/"));r.nonegate=!0,r.nocomment=!0,t.minimatch=new qt(e,r),t.options=t.minimatch.options},Ct.ownProp=It,Ct.makeAbs=Pt,Ct.finish=function(t){for(var e=t.nounique,r=e?[]:Object.create(null),i=0,s=t.matches.length;i<s;i++){var n=t.matches[i];if(n&&0!==Object.keys(n).length){var a=Object.keys(n);e?r.push.apply(r,a):a.forEach((function(t){r[t]=!0}))}else if(t.nonull){var o=t.minimatch.globSet[i];e?r.push(o):r[o]=!0}}e||(r=Object.keys(r));t.nosort||(r=r.sort(Dt));if(t.mark){for(i=0;i<r.length;i++)r[i]=t._mark(r[i]);t.nodir&&(r=r.filter((function(e){var r=!/\/$/.test(e),i=t.cache[e]||t.cache[Pt(t,e)];return r&&i&&(r="DIR"!==i&&!Array.isArray(i)),r})))}t.ignore.length&&(r=r.filter((function(e){return!zt(t,e)})));t.found=r},Ct.mark=function(t,e){var r=Pt(t,e),i=t.cache[r],s=e;if(i){var n="DIR"===i||Array.isArray(i),a="/"===e.slice(-1);if(n&&!a?s+="/":!n&&a&&(s=s.slice(0,-1)),s!==e){var o=Pt(t,s);t.statCache[o]=t.statCache[r],t.cache[o]=t.cache[r]}}return s},Ct.isIgnored=zt,Ct.childrenIgnored=function(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return!(!t.gmatcher||!t.gmatcher.match(e))}))};var Tt,Mt,Lt=t,Nt=i,Rt=lt,$t=i.isAbsolute,qt=Rt.Minimatch;function Dt(t,e){return t.localeCompare(e,"en")}function Bt(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new qt(r,{dot:!0})}return{matcher:new qt(t,{dot:!0}),gmatcher:e}}function Pt(t,e){var r=e;return r="/"===e.charAt(0)?Nt.join(t.root,e):$t(e)||""===e?e:t.changedCwd?Nt.resolve(t.cwd,e):Nt.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function zt(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))}))}var Ft=function t(e,r){if(e&&r)return t(e)(r);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){i[t]=e[t]})),i;function i(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var i=e.apply(this,t),s=t[t.length-1];return"function"==typeof i&&i!==s&&Object.keys(s).forEach((function(t){i[t]=s[t]})),i}};var Ut={exports:{}},Wt=Ft;function Gt(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function Qt(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}Ut.exports=Wt(Gt),Ut.exports.strict=Wt(Qt),Gt.proto=Gt((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Gt(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Qt(this)},configurable:!0})}));var Ht,Jt,Kt=Ut.exports,Vt=Ft,Yt=Object.create(null),Xt=Kt,Zt=Vt((function(t,e){return Yt[t]?(Yt[t].push(e),null):(Yt[t]=[e],function(t){return Xt((function e(){var r=Yt[t],i=r.length,s=function(t){for(var e=t.length,r=[],i=0;i<e;i++)r[i]=t[i];return r}(arguments);try{for(var n=0;n<i;n++)r[n].apply(null,s)}finally{r.length>i?(r.splice(0,i),process.nextTick((function(){e.apply(null,s)}))):delete Yt[t]}}))}(t))}));function te(){if(Jt)return Ht;Jt=1,Ht=y;var t=L,r=lt;r.Minimatch;var n=St,a=e.EventEmitter,o=i,h=s,c=i.isAbsolute,l=function(){if(Mt)return Tt;Mt=1,Tt=p,p.GlobSync=f;var t=L,e=lt;e.Minimatch,te().Glob;var r=i,n=s,a=i.isAbsolute,o=Ct,h=o.setopts,c=o.ownProp,l=o.childrenIgnored,u=o.isIgnored;function p(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new f(t,e).found}function f(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof f))return new f(t,e);if(h(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var i=0;i<r;i++)this._process(this.minimatch.set[i],i,!1);this._finish()}return f.prototype._finish=function(){if(n.ok(this instanceof f),this.realpath){var e=this;this.matches.forEach((function(r,i){var s=e.matches[i]=Object.create(null);for(var n in r)try{n=e._makeAbs(n),s[t.realpathSync(n,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;s[e._makeAbs(n)]=!0}}))}o.finish(this)},f.prototype._process=function(t,r,i){n.ok(this instanceof f);for(var s,o=0;"string"==typeof t[o];)o++;switch(o){case t.length:return void this._processSimple(t.join("/"),r);case 0:s=null;break;default:s=t.slice(0,o).join("/")}var h,c=t.slice(o);null===s?h=".":a(s)||a(t.map((function(t){return"string"==typeof t?t:"[*]"})).join("/"))?(s&&a(s)||(s="/"+s),h=s):h=s;var u=this._makeAbs(h);l(this,h)||(c[0]===e.GLOBSTAR?this._processGlobStar(s,h,u,c,r,i):this._processReaddir(s,h,u,c,r,i))},f.prototype._processReaddir=function(t,e,i,s,n,a){var o=this._readdir(i,a);if(o){for(var h=s[0],c=!!this.minimatch.negate,l=h._glob,u=this.dot||"."===l.charAt(0),p=[],f=0;f<o.length;f++)("."!==(m=o[f]).charAt(0)||u)&&(c&&!t?!m.match(h):m.match(h))&&p.push(m);var d=p.length;if(0!==d)if(1!==s.length||this.mark||this.stat)for(s.shift(),f=0;f<d;f++){var g;m=p[f],g=t?[t,m]:[m],this._process(g.concat(s),n,a)}else{this.matches[n]||(this.matches[n]=Object.create(null));for(f=0;f<d;f++){var m=p[f];t&&(m="/"!==t.slice(-1)?t+"/"+m:t+m),"/"!==m.charAt(0)||this.nomount||(m=r.join(this.root,m)),this._emitMatch(n,m)}}}},f.prototype._emitMatch=function(t,e){if(!u(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var i=this.cache[r];if("DIR"===i||Array.isArray(i))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},f.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r;try{r=this.fs.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var i=r&&r.isSymbolicLink();return this.symlinks[t]=i,i||!r||r.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},f.prototype._readdir=function(t,e){if(e&&!c(this.symlinks,t))return this._readdirInGlobStar(t);if(c(this.cache,t)){var r=this.cache[t];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},f.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var i=e[r];i="/"===t?t+i:t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,e},f.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);throw i.path=this.cwd,i.code=e.code,i}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},f.prototype._processGlobStar=function(t,e,r,i,s,n){var a=this._readdir(r,n);if(a){var o=i.slice(1),h=t?[t]:[],c=h.concat(o);this._process(c,s,!1);var l=a.length;if(!this.symlinks[r]||!n)for(var u=0;u<l;u++)if("."!==a[u].charAt(0)||this.dot){var p=h.concat(a[u],o);this._process(p,s,!0);var f=h.concat(a[u],i);this._process(f,s,!0)}}},f.prototype._processSimple=function(t,e){var i=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),i){if(t&&a(t)&&!this.nomount){var s=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=r.join(this.root,t):(t=r.resolve(this.root,t),s&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},f.prototype._stat=function(t){var e=this._makeAbs(t),r="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&c(this.cache,e)){var i=this.cache[e];if(Array.isArray(i)&&(i="DIR"),!r||"DIR"===i)return i;if(r&&"FILE"===i)return!1}var s=this.statCache[e];if(!s){var n;try{n=this.fs.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(n&&n.isSymbolicLink())try{s=this.fs.statSync(e)}catch(t){s=n}else s=n}return this.statCache[e]=s,i=!0,s&&(i=s.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||i,(!r||"FILE"!==i)&&i},f.prototype._mark=function(t){return o.mark(this,t)},f.prototype._makeAbs=function(t){return o.makeAbs(this,t)},Tt}(),u=Ct,p=u.setopts,f=u.ownProp,d=Zt,g=u.childrenIgnored,m=u.isIgnored,w=Kt;function y(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return l(t,e)}return new v(t,e,r)}y.sync=l;var b=y.GlobSync=l.GlobSync;function v(t,e,r){if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new b(t,e)}if(!(this instanceof v))return new v(t,e,r);p(this,t,e),this._didRealPath=!1;var i=this.minimatch.set.length;this.matches=new Array(i),"function"==typeof r&&(r=w(r),this.on("error",r),this.on("end",(function(t){r(null,t)})));var s=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===i)return o();for(var n=!0,a=0;a<i;a++)this._process(this.minimatch.set[a],a,!1,o);function o(){--s._processing,s._processing<=0&&(n?process.nextTick((function(){s._finish()})):s._finish())}n=!1}return y.glob=y,y.hasMagic=function(t,e){var r=function(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}({},e);r.noprocess=!0;var i=new v(t,r).minimatch.set;if(!t)return!1;if(i.length>1)return!0;for(var s=0;s<i[0].length;s++)if("string"!=typeof i[0][s])return!0;return!1},y.Glob=v,n(v,a),v.prototype._finish=function(){if(h(this instanceof v),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();u.finish(this),this.emit("end",this.found)}},v.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,i)}function i(){0==--t&&e._finish()}},v.prototype._realpathSet=function(e,r){var i=this.matches[e];if(!i)return r();var s=Object.keys(i),n=this,a=s.length;if(0===a)return r();var o=this.matches[e]=Object.create(null);s.forEach((function(i,s){i=n._makeAbs(i),t.realpath(i,n.realpathCache,(function(t,s){t?"stat"===t.syscall?o[i]=!0:n.emit("error",t):o[s]=!0,0==--a&&(n.matches[e]=o,r())}))}))},v.prototype._mark=function(t){return u.mark(this,t)},v.prototype._makeAbs=function(t){return u.makeAbs(this,t)},v.prototype.abort=function(){this.aborted=!0,this.emit("abort")},v.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},v.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var i=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<i.length;e++){var s=i[e];this._processing--,this._process(s[0],s[1],s[2],s[3])}}}},v.prototype._process=function(t,e,i,s){if(h(this instanceof v),h("function"==typeof s),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,i,s]);else{for(var n,a=0;"string"==typeof t[a];)a++;switch(a){case t.length:return void this._processSimple(t.join("/"),e,s);case 0:n=null;break;default:n=t.slice(0,a).join("/")}var o,l=t.slice(a);null===n?o=".":c(n)||c(t.map((function(t){return"string"==typeof t?t:"[*]"})).join("/"))?(n&&c(n)||(n="/"+n),o=n):o=n;var u=this._makeAbs(o);if(g(this,o))return s();l[0]===r.GLOBSTAR?this._processGlobStar(n,o,u,l,e,i,s):this._processReaddir(n,o,u,l,e,i,s)}},v.prototype._processReaddir=function(t,e,r,i,s,n,a){var o=this;this._readdir(r,n,(function(h,c){return o._processReaddir2(t,e,r,i,s,n,c,a)}))},v.prototype._processReaddir2=function(t,e,r,i,s,n,a,h){if(!a)return h();for(var c=i[0],l=!!this.minimatch.negate,u=c._glob,p=this.dot||"."===u.charAt(0),f=[],d=0;d<a.length;d++){if("."!==(m=a[d]).charAt(0)||p)(l&&!t?!m.match(c):m.match(c))&&f.push(m)}var g=f.length;if(0===g)return h();if(1===i.length&&!this.mark&&!this.stat){this.matches[s]||(this.matches[s]=Object.create(null));for(d=0;d<g;d++){var m=f[d];t&&(m="/"!==t?t+"/"+m:t+m),"/"!==m.charAt(0)||this.nomount||(m=o.join(this.root,m)),this._emitMatch(s,m)}return h()}i.shift();for(d=0;d<g;d++){m=f[d];t&&(m="/"!==t?t+"/"+m:t+m),this._process([m].concat(i),s,n,h)}h()},v.prototype._emitMatch=function(t,e){if(!this.aborted&&!m(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var r=c(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var i=this.cache[r];if("DIR"===i||Array.isArray(i))return}this.matches[t][e]=!0;var s=this.statCache[r];s&&this.emit("stat",e,s),this.emit("match",e)}}},v.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var r=this,i=d("lstat\0"+t,(function(i,s){if(i&&"ENOENT"===i.code)return e();var n=s&&s.isSymbolicLink();r.symlinks[t]=n,n||!s||s.isDirectory()?r._readdir(t,!1,e):(r.cache[t]="FILE",e())}));i&&r.fs.lstat(t,i)}},v.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=d("readdir\0"+t+"\0"+e,r))){if(e&&!f(this.symlinks,t))return this._readdirInGlobStar(t,r);if(f(this.cache,t)){var i=this.cache[t];if(!i||"FILE"===i)return r();if(Array.isArray(i))return r(null,i)}this.fs.readdir(t,function(t,e,r){return function(i,s){i?t._readdirError(e,i,r):t._readdirEntries(e,s,r)}}(this,t,r))}},v.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var i=0;i<e.length;i++){var s=e[i];s="/"===t?t+s:t+"/"+s,this.cache[s]=!0}return this.cache[t]=e,r(null,e)}},v.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var i=this._makeAbs(t);if(this.cache[i]="FILE",i===this.cwdAbs){var s=new Error(e.code+" invalid cwd "+this.cwd);s.path=this.cwd,s.code=e.code,this.emit("error",s),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},v.prototype._processGlobStar=function(t,e,r,i,s,n,a){var o=this;this._readdir(r,n,(function(h,c){o._processGlobStar2(t,e,r,i,s,n,c,a)}))},v.prototype._processGlobStar2=function(t,e,r,i,s,n,a,o){if(!a)return o();var h=i.slice(1),c=t?[t]:[],l=c.concat(h);this._process(l,s,!1,o);var u=this.symlinks[r],p=a.length;if(u&&n)return o();for(var f=0;f<p;f++){if("."!==a[f].charAt(0)||this.dot){var d=c.concat(a[f],h);this._process(d,s,!0,o);var g=c.concat(a[f],i);this._process(g,s,!0,o)}}o()},v.prototype._processSimple=function(t,e,r){var i=this;this._stat(t,(function(s,n){i._processSimple2(t,e,s,n,r)}))},v.prototype._processSimple2=function(t,e,r,i,s){if(this.matches[e]||(this.matches[e]=Object.create(null)),!i)return s();if(t&&c(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=o.join(this.root,t):(t=o.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),s()},v.prototype._stat=function(t,e){var r=this._makeAbs(t),i="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&f(this.cache,r)){var s=this.cache[r];if(Array.isArray(s)&&(s="DIR"),!i||"DIR"===s)return e(null,s);if(i&&"FILE"===s)return e()}var n=this.statCache[r];if(void 0!==n){if(!1===n)return e(null,n);var a=n.isDirectory()?"DIR":"FILE";return i&&"FILE"===a?e():e(null,a,n)}var o=this,h=d("stat\0"+r,(function(i,s){if(s&&s.isSymbolicLink())return o.fs.stat(r,(function(i,n){i?o._stat2(t,r,null,s,e):o._stat2(t,r,i,n,e)}));o._stat2(t,r,i,s,e)}));h&&o.fs.lstat(r,h)},v.prototype._stat2=function(t,e,r,i,s){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,s();var n="/"===t.slice(-1);if(this.statCache[e]=i,"/"===e.slice(-1)&&i&&!i.isDirectory())return s(null,!1,i);var a=!0;return i&&(a=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,n&&"FILE"===a?s():s(null,a,i)},Ht}
/*! simple-concat. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var ee=le;const re=function(t,e){var r=[];t.on("data",(function(t){r.push(t)})),t.once("end",(function(){e&&e(null,Buffer.concat(r)),e=null})),t.once("error",(function(t){e&&e(t),e=null}))},ie=u(Object.freeze({__proto__:null,default:{}})),se=n,ne=a,ae=Kt,oe=o,he=h,ce=t=>null!==t&&"object"==typeof t&&"function"==typeof t.pipe;function le(t,e){if(t=Object.assign({maxRedirects:10},"string"==typeof t?{url:t}:t),e=ae(e),t.url){const{hostname:e,port:r,protocol:i,auth:s,path:n}=he.parse(t.url);delete t.url,e||r||i||s?Object.assign(t,{hostname:e,port:r,protocol:i,auth:s,path:n}):t.path=n}const r={"accept-encoding":"gzip, deflate"};let i;t.headers&&Object.keys(t.headers).forEach((e=>r[e.toLowerCase()]=t.headers[e])),t.headers=r,t.body?i=t.json&&!ce(t.body)?JSON.stringify(t.body):t.body:t.form&&(i="string"==typeof t.form?t.form:oe.stringify(t.form),t.headers["content-type"]="application/x-www-form-urlencoded"),i&&(t.method||(t.method="POST"),ce(i)||(t.headers["content-length"]=Buffer.byteLength(i)),t.json&&!t.form&&(t.headers["content-type"]="application/json")),delete t.body,delete t.form,t.json&&(t.headers.accept="application/json"),t.method&&(t.method=t.method.toUpperCase());const s=t.hostname,n=("https:"===t.protocol?ne:se).request(t,(r=>{if(!1!==t.followRedirects&&r.statusCode>=300&&r.statusCode<400&&r.headers.location){t.url=r.headers.location,delete t.headers.host,r.resume();const i=he.parse(t.url).hostname;return null!==i&&i!==s&&(delete t.headers.cookie,delete t.headers.authorization),"POST"===t.method&&[301,302].includes(r.statusCode)&&(t.method="GET",delete t.headers["content-length"],delete t.headers["content-type"]),0==t.maxRedirects--?e(new Error("too many redirects")):le(t,e)}const i="function"==typeof ie&&"HEAD"!==t.method;e(null,i?ie(r):r)}));return n.on("timeout",(()=>{n.abort(),e(new Error("Request timed out"))})),n.on("error",e),ce(i)?i.on("error",e).pipe(n):n.end(i),n}le.concat=(t,e)=>le(t,((r,i)=>{if(r)return e(r);re(i,((r,s)=>{if(r)return e(r);if(t.json)try{s=JSON.parse(s.toString())}catch(r){return e(r,i,s)}e(null,i,s)}))})),["get","post","put","patch","head","delete"].forEach((t=>{le[t]=(e,r)=>("string"==typeof e&&(e={url:e}),le(Object.assign({method:t.toUpperCase()},e),r))}));const{inspect:ue}=r;let pe=class t{constructor(t=0,e=0,r=0,i=1){this.x=t,this.y=e,this.z=r,this.w=i}static fromPoint(e){return new t(e.x,e.y,void 0!==e.z?e.z:0,void 0!==e.w?e.w:1)}matrixTransform(e){return(e.is2D||e instanceof SVGMatrix)&&0===this.z&&1===this.w?new t(this.x*e.a+this.y*e.c+e.e,this.x*e.b+this.y*e.d+e.f,0,1):new t(this.x*e.m11+this.y*e.m21+this.z*e.m31+this.w*e.m41,this.x*e.m12+this.y*e.m22+this.z*e.m32+this.w*e.m42,this.x*e.m13+this.y*e.m23+this.z*e.m33+this.w*e.m43,this.x*e.m14+this.y*e.m24+this.z*e.m34+this.w*e.m44)}toJSON(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};class fe{constructor(t=0,e=0,r=0,i=0){this.x=t,this.y=e,this.width=r,this.height=i}static fromRect(t){return new fe(t.x,t.y,t.width,t.height)}get top(){return this.y}get left(){return this.x}get right(){return this.x+this.width}get bottom(){return this.y+this.height}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,left:this.left,right:this.right,bottom:this.bottom}}}for(let t of["top","right","bottom","left"]){let e=Object.getOwnPropertyDescriptor(fe.prototype,t);e.enumerable=!0,Object.defineProperty(fe.prototype,t,e)}const de=10,ge=12,me=13,we=15,ye=180/Math.PI,be=Math.PI/180,ve=Symbol(),_e=Symbol();let xe=t=>{let e=t.split(/\(/,1)[0];if("matrix"===e)return(t=>{let e=t.replace(/matrix\(/,"");if(e=e.split(/,/,7),6!==e.length)throw new Error(`Failed to parse ${t}`);return e=e.map(parseFloat),[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,e[4],e[5],0,1]})(t);if("matrix3d"===e)return(t=>{let e=t.replace(/matrix3d\(/,"");if(e=e.split(/,/,17),16!==e.length)throw new Error(`Failed to parse ${t}`);return e.map(parseFloat)})(t);throw new Error(`${e} parsing not implemented`)},ke=(t,e,r)=>{if("number"!=typeof r)throw new TypeError("Expected number");t[ve][e]=r},Ee=(t,e,r)=>{if("number"!=typeof r)throw new TypeError("Expected number");e===de||e===we?1!==r&&(t[_e]=!1):0!==r&&(t[_e]=!1),t[ve][e]=r},Ae=t=>{let e=Object.create(Oe.prototype);return e.constructor=Oe,e[_e]=!0,e[ve]=t,e},je=(t,e)=>{let r=new Float64Array(16);for(let i=0;i<4;i++)for(let s=0;s<4;s++){let n=0;for(let r=0;r<4;r++)n+=t[4*i+r]*e[4*r+s];r[4*i+s]=n}return r};class Oe{get m11(){return this[ve][0]}set m11(t){ke(this,0,t)}get m12(){return this[ve][1]}set m12(t){ke(this,1,t)}get m13(){return this[ve][2]}set m13(t){Ee(this,2,t)}get m14(){return this[ve][3]}set m14(t){Ee(this,3,t)}get m21(){return this[ve][4]}set m21(t){ke(this,4,t)}get m22(){return this[ve][5]}set m22(t){ke(this,5,t)}get m23(){return this[ve][6]}set m23(t){Ee(this,6,t)}get m24(){return this[ve][7]}set m24(t){Ee(this,7,t)}get m31(){return this[ve][8]}set m31(t){Ee(this,8,t)}get m32(){return this[ve][9]}set m32(t){Ee(this,9,t)}get m33(){return this[ve][10]}set m33(t){Ee(this,de,t)}get m34(){return this[ve][11]}set m34(t){Ee(this,11,t)}get m41(){return this[ve][12]}set m41(t){ke(this,ge,t)}get m42(){return this[ve][13]}set m42(t){ke(this,me,t)}get m43(){return this[ve][14]}set m43(t){Ee(this,14,t)}get m44(){return this[ve][15]}set m44(t){Ee(this,we,t)}get a(){return this[ve][0]}set a(t){ke(this,0,t)}get b(){return this[ve][1]}set b(t){ke(this,1,t)}get c(){return this[ve][4]}set c(t){ke(this,4,t)}get d(){return this[ve][5]}set d(t){ke(this,5,t)}get e(){return this[ve][12]}set e(t){ke(this,12,t)}get f(){return this[ve][13]}set f(t){ke(this,13,t)}get is2D(){return this[_e]}get isIdentity(){let t=this[ve];return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}static fromMatrix(t){if(t instanceof Oe)return new Oe(t[ve]);if(t instanceof SVGMatrix)return new Oe([t.a,t.b,t.c,t.d,t.e,t.f]);throw new TypeError("Expected DOMMatrix")}static fromFloat32Array(t){if(!(t instanceof Float32Array))throw new TypeError("Expected Float32Array");return new Oe(t)}static fromFloat64Array(t){if(!(t instanceof Float64Array))throw new TypeError("Expected Float64Array");return new Oe(t)}constructor(t){if(this[_e]=!0,this[ve]=new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),"string"==typeof t){if(""===t)return;{let e=t.split(/\)\s+/,20).map(xe);if(0===e.length)return;t=e[0];for(let r=1;r<e.length;r++)t=je(e[r],t)}}let e=0;if(t&&6===t.length)ke(this,0,t[e++]),ke(this,1,t[e++]),ke(this,4,t[e++]),ke(this,5,t[e++]),ke(this,12,t[e++]),ke(this,13,t[e++]);else if(t&&16===t.length)ke(this,0,t[e++]),ke(this,1,t[e++]),Ee(this,2,t[e++]),Ee(this,3,t[e++]),ke(this,4,t[e++]),ke(this,5,t[e++]),Ee(this,6,t[e++]),Ee(this,7,t[e++]),Ee(this,8,t[e++]),Ee(this,9,t[e++]),Ee(this,de,t[e++]),Ee(this,11,t[e++]),ke(this,ge,t[e++]),ke(this,me,t[e++]),Ee(this,14,t[e++]),Ee(this,we,t[e]);else if(void 0!==t)throw new TypeError("Expected string or array.")}dump(){let t=this[ve];console.log([t.slice(0,4),t.slice(4,8),t.slice(8,12),t.slice(12,16)])}[ue.custom](t,e){if(t<0)return"[DOMMatrix]";let{a:r,b:i,c:s,d:n,e:a,f:o,is2D:h,isIdentity:c}=this;if(this.is2D)return`DOMMatrix ${ue({a:r,b:i,c:s,d:n,e:a,f:o,is2D:h,isIdentity:c},{colors:!0})}`;{let{m11:t,m12:e,m13:h,m14:c,m21:l,m22:u,m23:p,m24:f,m31:d,m32:g,m33:m,m34:w,m41:y,m42:b,m43:v,m44:_,is2D:x,isIdentity:k}=this;return`DOMMatrix ${ue({a:r,b:i,c:s,d:n,e:a,f:o,m11:t,m12:e,m13:h,m14:c,m21:l,m22:u,m23:p,m24:f,m31:d,m32:g,m33:m,m34:w,m41:y,m42:b,m43:v,m44:_,is2D:x,isIdentity:k},{colors:!0})}`}}multiply(t){return Ae(this[ve]).multiplySelf(t)}multiplySelf(t){return this[ve]=je(t[ve],this[ve]),t.is2D||(this[_e]=!1),this}preMultiplySelf(t){return this[ve]=je(this[ve],t[ve]),t.is2D||(this[_e]=!1),this}translate(t,e,r){return Ae(this[ve]).translateSelf(t,e,r)}translateSelf(t=0,e=0,r=0){return this[ve]=je([1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1],this[ve]),0!==r&&(this[_e]=!1),this}scale(t,e,r,i,s,n){return Ae(this[ve]).scaleSelf(t,e,r,i,s,n)}scale3d(t,e,r,i){return Ae(this[ve]).scale3dSelf(t,e,r,i)}scale3dSelf(t,e,r,i){return this.scaleSelf(t,t,t,e,r,i)}scaleSelf(t,e,r,i,s,n){return"number"!=typeof i&&(i=0),"number"!=typeof s&&(s=0),"number"!=typeof n&&(n=0),this.translateSelf(i,s,n),"number"!=typeof t&&(t=1),"number"!=typeof e&&(e=t),"number"!=typeof r&&(r=1),this[ve]=je([t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1],this[ve]),this.translateSelf(-i,-s,-n),1===r&&0===n||(this[_e]=!1),this}rotateFromVector(t,e){return Ae(this[ve]).rotateFromVectorSelf(t,e)}rotateFromVectorSelf(t=0,e=0){let r=0===t&&0===e?0:Math.atan2(e,t)*ye;return this.rotateSelf(r)}rotate(t,e,r){return Ae(this[ve]).rotateSelf(t,e,r)}rotateSelf(t,e,r){void 0===e&&void 0===r&&(r=t,t=e=0),"number"!=typeof e&&(e=0),"number"!=typeof r&&(r=0),0===t&&0===e||(this[_e]=!1),t*=be,e*=be,r*=be;let i=Math.cos(r),s=Math.sin(r);return this[ve]=je([i,s,0,0,-s,i,0,0,0,0,1,0,0,0,0,1],this[ve]),i=Math.cos(e),s=Math.sin(e),this[ve]=je([i,0,-s,0,0,1,0,0,s,0,i,0,0,0,0,1],this[ve]),i=Math.cos(t),s=Math.sin(t),this[ve]=je([1,0,0,0,0,i,s,0,0,-s,i,0,0,0,0,1],this[ve]),this}rotateAxisAngle(t,e,r,i){return Ae(this[ve]).rotateAxisAngleSelf(t,e,r,i)}rotateAxisAngleSelf(t=0,e=0,r=0,i=0){let s=Math.sqrt(t*t+e*e+r*r);if(0===s)return this;1!==s&&(t/=s,e/=s,r/=s),i*=be;let n=Math.cos(i),a=Math.sin(i),o=1-n,h=o*t,c=o*e;return this[ve]=je([h*t+n,h*e+a*r,h*r-a*e,0,h*e-a*r,c*e+n,c*r+a*t,0,h*r+a*e,c*r-a*t,o*r*r+n,0,0,0,0,1],this[ve]),0===t&&0===e||(this[_e]=!1),this}skewX(t){return Ae(this[ve]).skewXSelf(t)}skewXSelf(t){if("number"!=typeof t)return this;let e=Math.tan(t*be);return this[ve]=je([1,0,0,0,e,1,0,0,0,0,1,0,0,0,0,1],this[ve]),this}skewY(t){return Ae(this[ve]).skewYSelf(t)}skewYSelf(t){if("number"!=typeof t)return this;let e=Math.tan(t*be);return this[ve]=je([1,e,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this[ve]),this}flipX(){return Ae(je([-1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this[ve]))}flipY(){return Ae(je([1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],this[ve]))}inverse(){return Ae(this[ve]).invertSelf()}invertSelf(){if(!this[_e])throw new Error("3D matrix inversion is not implemented.");{let t=this[ve][0]*this[ve][5]-this[ve][1]*this[ve][4];if(0!==t){let e=new Oe;return e.a=this[ve][5]/t,e.b=-this[ve][1]/t,e.c=-this[ve][4]/t,e.d=this[ve][0]/t,e.e=(this[ve][4]*this[ve][13]-this[ve][5]*this[ve][12])/t,e.f=(this[ve][1]*this[ve][12]-this[ve][0]*this[ve][13])/t,e}this[_e]=!1,this[ve]=[NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN]}}setMatrixValue(t){let e=new Oe(t);return this[ve]=e[ve],this[_e]=e[_e],this}transformPoint(t){let e=t.x,r=t.y,i=t.z,s=t.w,n=this[ve],a=n[0]*e+n[4]*r+n[8]*i+n[12]*s,o=n[1]*e+n[5]*r+n[9]*i+n[13]*s,h=n[2]*e+n[6]*r+n[10]*i+n[14]*s,c=n[3]*e+n[7]*r+n[11]*i+n[15]*s;return new pe(a,o,h,c)}toFloat32Array(){return Float32Array.from(this[ve])}toFloat64Array(){return this[ve].slice(0)}toJSON(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,m11:this.m11,m12:this.m12,m13:this.m13,m14:this.m14,m21:this.m21,m22:this.m22,m23:this.m23,m24:this.m24,m31:this.m31,m32:this.m32,m33:this.m33,m34:this.m34,m41:this.m41,m42:this.m42,m43:this.m43,m44:this.m44,is2D:this.is2D,isIdentity:this.isIdentity}}toString(){return this.is2D?`matrix(${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e}, ${this.f})`:`matrix3d(${this[ve].join(", ")})`}}for(let t of["a","b","c","d","e","f","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","is2D","isIdentity"]){let e=Object.getOwnPropertyDescriptor(Oe.prototype,t);e.enumerable=!0,Object.defineProperty(Oe.prototype,t,e)}var Se={DOMPoint:pe,DOMMatrix:Oe,DOMRect:fe};function Ce(t,e){if("string"!=typeof t)return[t];var r=[t];"string"==typeof e||Array.isArray(e)?e={brackets:e}:e||(e={});var i=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],s=e.escape||"___",n=!!e.flat;i.forEach((function(t){var e=new RegExp(["\\",t[0],"[^\\",t[0],"\\",t[1],"]*\\",t[1]].join("")),i=[];function n(e,n,a){var o=r.push(e.slice(t[0].length,-t[1].length))-1;return i.push(o),s+o+s}r.forEach((function(t,i){for(var s,a=0;t!=s;)if(s=t,t=t.replace(e,n),a++>1e4)throw Error("References have circular dependency. Please, check them.");r[i]=t})),i=i.reverse(),r=r.map((function(e){return i.forEach((function(r){e=e.replace(new RegExp("(\\"+s+r+"\\"+s+")","g"),t[0]+"$1"+t[1])})),e}))}));var a=new RegExp("\\"+s+"([0-9]+)\\"+s);return n?r:function t(e,r,i){for(var s,n=[],o=0;s=a.exec(e);){if(o++>1e4)throw Error("Circular references in parenthesis");n.push(e.slice(0,s.index)),n.push(t(r[s[1]],r)),e=e.slice(s.index+s[0].length)}return n.push(e),n}(r[0],r)}function Ie(t,e){if(e&&e.flat){var r,i=e&&e.escape||"___",s=t[0];if(!s)return"";for(var n=new RegExp("\\"+i+"([0-9]+)\\"+i),a=0;s!=r;){if(a++>1e4)throw Error("Circular references in "+t);r=s,s=s.replace(n,o)}return s}return t.reduce((function t(e,r){return Array.isArray(r)&&(r=r.reduce(t,"")),e+r}),"");function o(e,r){if(null==t[r])throw Error("Reference "+r+"is undefined");return t[r]}}function Te(t,e){return Array.isArray(t)?Ie(t,e):Ce(t,e)}Te.parse=Ce,Te.stringify=Ie;var Me,Le=Te,Ne=function(t,e,r){if(null==t)throw Error("First argument should be a string");if(null==e)throw Error("Separator should be a string or a RegExp");r?("string"==typeof r||Array.isArray(r))&&(r={ignore:r}):r={},null==r.escape&&(r.escape=!0),null==r.ignore?r.ignore=["[]","()","{}","<>",'""',"''","``","",""]:("string"==typeof r.ignore&&(r.ignore=[r.ignore]),r.ignore=r.ignore.map((function(t){return 1===t.length&&(t+=t),t})));var i=Le.parse(t,{flat:!0,brackets:r.ignore}),s=i[0].split(e);if(r.escape){for(var n=[],a=0;a<s.length;a++){var o=s[a],h=s[a+1];"\\"===o[o.length-1]&&"\\"!==o[o.length-2]?(n.push(o+e+h),a++):n.push(o)}s=n}for(a=0;a<s.length;a++)i[0]=s[a],s[a]=Le.stringify(i,{flat:!0});return s},{DOMPoint:Re}=Se,$e={font:{},variant:{}};const qe=/^(normal|italic|oblique)$/,De=/^(normal|small-caps)$/,Be=/^(normal|(semi-|extra-|ultra-)?(condensed|expanded))$/,Pe=/(?:xx?-)?small|smaller|medium|larger|(?:xx?-)?large|normal/,ze=/^([\d\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q)/,Fe=/^(normal|bold(er)?|lighter)$/,Ue=/^(1000|\d{1,3})$/,We=/([\w\-]+)\((.*?)\)/,Ge=t=>t.replace(/^(['"])(.*?)\1$/,"$2"),Qe=t=>Pe.test(t)||ze.test(t);function He(t,e=16){if(Me=ze.exec(t)){let[t,r]=[parseFloat(Me[1]),Me[2]];return t*("px"==r?1:"pt"==r?1/.75:"%"==r?e/100:"pc"==r?16:"in"==r?96:"cm"==r?96/2.54:"mm"==r?96/25.4:"q"==r?96/25.4/4:r.match("r?em")?e:NaN)}return(Me=Pe.exec(t))?e*(ir[Me[0]]||1):NaN}function Je(t){return(Me=Ue.exec(t))?parseInt(Me[0])||NaN:(Me=Fe.exec(t))?rr[Me[0]]:NaN}let Ke=["default","crosshair","hand","arrow","move","text","wait","help","progress","not-allowed","context-menu","cell","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","zoom-in","zoom-out","e-resize","n-resize","ne-resize","nw-resize","s-resize","se-resize","sw-resize","w-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","col-resize","row-resize","none"];var Ve=/(blur|hue-rotate|brightness|contrast|grayscale|invert|opacity|saturate|sepia)\((.*?)\)/,Ye=/drop-shadow\((.*)\)/,Xe=/^(\+|-)?\d+%$/,Ze=/([\d\.]+)(deg|g?rad|turn)/;function tr(t){return Xe.test(t.trim())?parseInt(t,10)/100:NaN}function er(t){if(Me=Ze.exec(t.trim())){let[t,e]=[parseFloat(Me[1]),Me[2]];return"deg"==e?t:"rad"==e?360*t/(2*Math.PI):"grad"==e?360*t/400:"turn"==e?360*t:NaN}}const rr={lighter:300,normal:400,bold:700,bolder:800},ir={"xx-small":.6,"x-small":3/4,small:8/9,smaller:8/9,large:1.2,larger:1.2,"x-large":1.5,"xx-large":2,normal:1.2},sr={normal:[],"common-ligatures":["liga","clig"],"no-common-ligatures":["-liga","-clig"],"discretionary-ligatures":["dlig"],"no-discretionary-ligatures":["-dlig"],"historical-ligatures":["hlig"],"no-historical-ligatures":["-hlig"],contextual:["calt"],"no-contextual":["-calt"],super:["sups"],sub:["subs"],"small-caps":["smcp"],"all-small-caps":["c2sc","smcp"],"petite-caps":["pcap"],"all-petite-caps":["c2pc","pcap"],unicase:["unic"],"titling-caps":["titl"],"lining-nums":["lnum"],"oldstyle-nums":["onum"],"proportional-nums":["pnum"],"tabular-nums":["tnum"],"diagonal-fractions":["frac"],"stacked-fractions":["afrc"],ordinal:["ordn"],"slashed-zero":["zero"],jis78:["jp78"],jis83:["jp83"],jis90:["jp90"],jis04:["jp04"],simplified:["smpl"],traditional:["trad"],"full-width":["fwid"],"proportional-width":["pwid"],ruby:["ruby"],"historical-forms":["hist"]},nr={stylistic:"salt #",styleset:"ss##","character-variant":"cv##",swash:"swsh #",ornaments:"ornm #",annotation:"nalt #"};var ar={font:function(t){if(void 0===$e.font[t])try{if("string"!=typeof t)throw new Error("Font specification must be a string");if(!t)throw new Error("Font specification cannot be an empty string");let r,i={style:"normal",variant:"normal",weight:"normal",stretch:"normal"},s=t.replace(/\s*\/\*s/,"/"),n=Ne(s,/\s+/);for(;r=n.shift();){let s=qe.test(r)?"style":De.test(r)?"variant":Be.test(r)?"stretch":(e=r,Fe.test(e)||Ue.test(e)?"weight":Qe(r)?"size":null);switch(s){case"style":case"variant":case"stretch":case"weight":i[s]=r;break;case"size":let[e,a]=Ne(r,"/"),o=He(e),h=He((a||"1.2").replace(/(\d)$/,"$1em"),o),c=Je(i.weight),l=Ne(n.join(" "),/\s*,\s*/).map(Ge),u="small-caps"==i.variant?{on:["smcp","onum"]}:{},{style:p,stretch:f,variant:d}=i,g=isFinite(o)?isFinite(h)?isFinite(c)?0==l.length&&`font family "${n.join(", ")}"`:`font weight "${i.weight}"`:`line height "${a}"`:`font size "${e}"`;if(!g)return $e.font[t]=Object.assign(i,{size:o,lineHeight:h,weight:c,family:l,features:u,canonical:[p,d!==p&&d,-1==[d,p].indexOf(c)&&c,-1==[d,p,c].indexOf(f)&&f,`${o}px/${h}px`,l.map((t=>t.match(/\s/)?`"${t}"`:t)).join(", ")].filter(Boolean).join(" ")});throw new Error(`Invalid ${g}`);default:throw new Error(`Unrecognized font attribute "${r}"`)}}throw new Error("Could not find a font size value")}catch(e){$e.font[t]=null}var e;return $e.font[t]},variant:function(t){if(void 0===$e.variant[t]){let e=[],r={on:[],off:[]};for(let i of Ne(t,/\s+/)){if("normal"==i)return{variants:[i],features:{on:[],off:[]}};if(i in sr)sr[i].forEach((t=>{"-"==t[0]?r.off.push(t.slice(1)):r.on.push(t)})),e.push(i);else{if(!(Me=We.exec(i)))throw new Error(`Invalid font variant "${i}"`);{let t=nr[Me[1]],i=Math.max(0,Math.min(99,parseInt(Me[2],10))),[s,n]=t.replace(/##/,i<10?"0"+i:i).replace(/#/,Math.min(9,i)).split(" ");void 0===n?r.on.push(s):r[s]=parseInt(n,10),e.push(`${Me[1]}(${i})`)}}}$e.variant[t]={variant:e.join(" "),features:r}}return $e.variant[t]},size:He,filter:function(t){let e={},r=[];for(var i of Ne(t,/\s+/)||[])if(Me=Ye.exec(i)){let t="drop-shadow",i=Me[1].trim().split(/\s+/),s=i.slice(0,3),n=i.slice(3).join(" "),a=s.map((t=>He(t))).filter(isFinite);3==a.length&&n&&(e[t]=[...a,n],r.push(`${t}(${s.join(" ")} ${n.replace(/ /g,"")})`))}else if(Me=Ve.exec(i)){let[t,i]=Me.slice(1),s="blur"==t?He(i):"hue-rotate"==t?er(i):tr(i);isFinite(s)&&(e[t]=s,r.push(`${t}(${i.trim()})`))}return"none"==t.trim()?{canonical:"none",filters:e}:r.length?{canonical:r.join(" "),filters:e}:null},cursor:function(t){return Ke.includes(t)},fit:function(t){return["none","contain-x","contain-y","contain","cover","fill","scale-down","resize"].includes(t)},radii:function(t){if((t=[t].flat().map((t=>t instanceof Re?t:new Re(t,t))).slice(0,4)).some((t=>!Number.isFinite(t.x)||!Number.isFinite(t.y))))return null;if(t.some((t=>t.x<0||t.y<0)))throw new Error("Corner radius cannot be negative");return 1==t.length?[t[0],t[0],t[0],t[0]]:2==t.length?[t[0],t[1],t[0],t[1]]:3==t.length?[t[0],t[1],t[2],t[1]]:4==t.length?[t[0],t[1],t[2],t[3]]:[0,0,0,0].map((t=>new Re(t,t)))}};function or(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function hr(t,e){for(var r,i="",s=0,n=-1,a=0,o=0;o<=t.length;++o){if(o<t.length)r=t.charCodeAt(o);else{if(47===r)break;r=47}if(47===r){if(n===o-1||1===a);else if(n!==o-1&&2===a){if(i.length<2||2!==s||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var h=i.lastIndexOf("/");if(h!==i.length-1){-1===h?(i="",s=0):s=(i=i.slice(0,h)).length-1-i.lastIndexOf("/"),n=o,a=0;continue}}else if(2===i.length||1===i.length){i="",s=0,n=o,a=0;continue}e&&(i.length>0?i+="/..":i="..",s=2)}else i.length>0?i+="/"+t.slice(n+1,o):i=t.slice(n+1,o),s=o-n-1;n=o,a=0}else 46===r&&-1!==a?++a:a=-1}return i}var cr={resolve:function(){for(var t,e="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var s;i>=0?s=arguments[i]:(void 0===t&&(t=process.cwd()),s=t),or(s),0!==s.length&&(e=s+"/"+e,r=47===s.charCodeAt(0))}return e=hr(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(t){if(or(t),0===t.length)return".";var e=47===t.charCodeAt(0),r=47===t.charCodeAt(t.length-1);return 0!==(t=hr(t,!e)).length||e||(t="."),t.length>0&&r&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return or(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,e=0;e<arguments.length;++e){var r=arguments[e];or(r),r.length>0&&(void 0===t?t=r:t+="/"+r)}return void 0===t?".":cr.normalize(t)},relative:function(t,e){if(or(t),or(e),t===e)return"";if((t=cr.resolve(t))===(e=cr.resolve(e)))return"";for(var r=1;r<t.length&&47===t.charCodeAt(r);++r);for(var i=t.length,s=i-r,n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var a=e.length-n,o=s<a?s:a,h=-1,c=0;c<=o;++c){if(c===o){if(a>o){if(47===e.charCodeAt(n+c))return e.slice(n+c+1);if(0===c)return e.slice(n+c)}else s>o&&(47===t.charCodeAt(r+c)?h=c:0===c&&(h=0));break}var l=t.charCodeAt(r+c);if(l!==e.charCodeAt(n+c))break;47===l&&(h=c)}var u="";for(c=r+h+1;c<=i;++c)c!==i&&47!==t.charCodeAt(c)||(0===u.length?u+="..":u+="/..");return u.length>0?u+e.slice(n+h):(n+=h,47===e.charCodeAt(n)&&++n,e.slice(n))},_makeLong:function(t){return t},dirname:function(t){if(or(t),0===t.length)return".";for(var e=t.charCodeAt(0),r=47===e,i=-1,s=!0,n=t.length-1;n>=1;--n)if(47===(e=t.charCodeAt(n))){if(!s){i=n;break}}else s=!1;return-1===i?r?"/":".":r&&1===i?"//":t.slice(0,i)},basename:function(t,e){if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');or(t);var r,i=0,s=-1,n=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var a=e.length-1,o=-1;for(r=t.length-1;r>=0;--r){var h=t.charCodeAt(r);if(47===h){if(!n){i=r+1;break}}else-1===o&&(n=!1,o=r+1),a>=0&&(h===e.charCodeAt(a)?-1==--a&&(s=r):(a=-1,s=o))}return i===s?s=o:-1===s&&(s=t.length),t.slice(i,s)}for(r=t.length-1;r>=0;--r)if(47===t.charCodeAt(r)){if(!n){i=r+1;break}}else-1===s&&(n=!1,s=r+1);return-1===s?"":t.slice(i,s)},extname:function(t){or(t);for(var e=-1,r=0,i=-1,s=!0,n=0,a=t.length-1;a>=0;--a){var o=t.charCodeAt(a);if(47!==o)-1===i&&(s=!1,i=a+1),46===o?-1===e?e=a:1!==n&&(n=1):-1!==e&&(n=-1);else if(!s){r=a+1;break}}return-1===e||-1===i||0===n||1===n&&e===i-1&&e===r+1?"":t.slice(e,i)},format:function(t){if(null===t||"object"!=typeof t)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return function(t,e){var r=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+i:r+t+i:i}("/",t)},parse:function(t){or(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;var r,i=t.charCodeAt(0),s=47===i;s?(e.root="/",r=1):r=0;for(var n=-1,a=0,o=-1,h=!0,c=t.length-1,l=0;c>=r;--c)if(47!==(i=t.charCodeAt(c)))-1===o&&(h=!1,o=c+1),46===i?-1===n?n=c:1!==l&&(l=1):-1!==n&&(l=-1);else if(!h){a=c+1;break}return-1===n||-1===o||0===l||1===l&&n===o-1&&n===a+1?-1!==o&&(e.base=e.name=0===a&&s?t.slice(1,o):t.slice(a,o)):(0===a&&s?(e.name=t.slice(1,n),e.base=t.slice(1,o)):(e.name=t.slice(a,n),e.base=t.slice(a,o)),e.ext=t.slice(n,o)),a>0?e.dir=t.slice(0,a-1):s&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};cr.posix=cr;var lr=cr;const{basename:ur,extname:pr}=lr;class fr{constructor(){let t=void 0===c,e="image/png",r="image/jpeg",i="image/jpeg",s="image/webp",n="application/pdf",a="image/svg+xml";Object.assign(this,{toMime:this.toMime.bind(this),fromMime:this.fromMime.bind(this),expected:t?'"png", "jpg", or "webp"':'"png", "jpg", "pdf", or "svg"',formats:t?{png:e,jpg:r,jpeg:i,webp:s}:{png:e,jpg:r,jpeg:i,pdf:n,svg:a},mimes:t?{[e]:"png",[r]:"jpg",[s]:"webp"}:{[e]:"png",[r]:"jpg",[n]:"pdf",[a]:"svg"}})}toMime(t){return this.formats[(t||"").replace(/^\./,"").toLowerCase()]}fromMime(t){return this.mimes[t]}}class dr{static for(t){return(new dr).append(t).get()}constructor(){this.crc=-1}get(){return~this.crc}append(t){for(var e=0|this.crc,r=this.table,i=0,s=0|t.length;i<s;i++)e=e>>>8^r[255&(e^t[i])];return this.crc=e,this}}function gr(t){let e=new Uint8Array(t),r=new DataView(e.buffer),i={array:e,view:r,size:t,set8:(t,e)=>(r.setUint8(t,e),i),set16:(t,e)=>(r.setUint16(t,e,!0),i),set32:(t,e)=>(r.setUint32(t,e,!0),i),bytes:(t,r)=>(e.set(r,t),i)};return i}dr.prototype.table=(()=>{var t,e,r,i=[];for(t=0;t<256;t++){for(r=t,e=0;e<8;e++)r=1&r?r>>>1^3988292384:r>>>1;i[t]=r}return i})();class mr{static encoder=new TextEncoder;constructor(t){let e=new Date;Object.assign(this,{directory:t,offset:0,files:[],time:(e.getHours()<<6|e.getMinutes())<<5|e.getSeconds()/2,date:(e.getFullYear()-1980<<4|e.getMonth()+1)<<5|e.getDate()}),this.add(t)}async add(t,e){let r=!e,i=mr.encoder.encode(`${this.directory}/${r?"":t}`),s=new Uint8Array(r?0:await e.arrayBuffer()),n=30+i.length,a=n+s.length,{offset:o}=this,h=gr(26).set32(0,134742036).set16(6,this.time).set16(8,this.date).set32(10,dr.for(s)).set32(14,s.length).set32(18,s.length).set16(22,i.length);o+=n;let c=gr(n+s.length+16).set32(0,67324752).bytes(4,h.array).bytes(30,i).bytes(n,s);o+=s.length,c.set32(a,134695760).bytes(a+4,h.array.slice(10,22)),o+=16,this.files.push({offset:o,folder:r,name:i,header:h,payload:c}),this.offset=o}toBuffer(){let t=this.files.reduce(((t,{name:e})=>46+e.length+t),0),e=gr(t+22),r=0;for(var{offset:i,name:s,header:n,folder:a}of this.files)e.set32(r,33639248).set16(r+4,20).bytes(r+6,n.array).set8(r+38,a?16:0).set32(r+42,i).bytes(r+46,s),r+=46+s.length;e.set32(r,101010256).set16(r+8,this.files.length).set16(r+10,this.files.length).set32(r+12,t).set32(r+16,this.offset);let o=new Uint8Array(this.offset+e.size),h=0;for(var{payload:c}of this.files)o.set(c.array,h),h+=c.size;return o.set(e.array,h),o}get blob(){return new Blob([this.toBuffer()],{type:"application/zip"})}}const wr=(t,e,r,i)=>{if(i){let{width:e,height:r}=t,s=Object.assign(document.createElement("canvas"),{width:e,height:r}),n=s.getContext("2d");n.fillStyle=i,n.fillRect(0,0,e,r),n.drawImage(t,0,0),t=s}return new Promise(((i,s)=>t.toBlob(i,e,r)))},yr=(t,e)=>{const r=window.URL.createObjectURL(e),i=document.createElement("a");i.style.display="none",i.href=r,i.setAttribute("download",t),void 0===i.download&&i.setAttribute("target","_blank"),document.body.appendChild(i),i.click(),document.body.removeChild(i),setTimeout((()=>window.URL.revokeObjectURL(r)),100)};var br={asBuffer:(...t)=>wr(...t).then((t=>t.arrayBuffer())),asDownload:async(t,e,r,i,s)=>{yr(s,await wr(t,e,r,i))},asZipDownload:async(t,e,r,i,s,n,a)=>{let o=ur(s,".zip")||"archive",h=new mr(o);await Promise.all(t.map((async(t,s)=>{let o=(t=>n.replace("{}",String(t+1).padStart(a,"0")))(s);await h.add(o,await wr(t,e,r,i))}))),yr(`${o}.zip`,h.blob)},atScale:(t,e,r)=>t.map((t=>{if(1==e&&!r)return t.canvas;let i=document.createElement("canvas"),s=i.getContext("2d"),n=t.canvas?t.canvas:t;return i.width=n.width*e,i.height=n.height*e,r&&(s.fillStyle=r,s.fillRect(0,0,i.width,i.height)),s.scale(e,e),s.drawImage(n,0,0),i})),options:function(t,{filename:e="",extension:r="",format:i,page:s,quality:n,matte:a,density:o,outline:h,archive:c}={}){var{fromMime:l,toMime:u,expected:p}=new fr,f=(c=c||"canvas",i||r.replace(/@\d+x$/i,"")||pr(e)),d=(i=l(u(f)||f),u(i)),g=t.length;if(!f)throw new Error("Cannot determine image format (use a filename extension or 'format' argument)");if(!i)throw new Error(`Unsupported file format "${f}" (expected ${p})`);if(!g)throw new RangeError("Canvas has no associated contexts (try calling getContext or newPage first)");let m,w,y=e.replace(/{(\d*)}/g,((t,e)=>(w=!0,e=parseInt(e,10),m=isFinite(e)?e:isFinite(m)?m:-1,"{}"))),b=s>0?s-1:s<0?g+s:void 0;if(isFinite(b)&&b<0||b>=g)throw new RangeError(1==g?`Canvas only has a page 1 (${b} is out of bounds)`:`Canvas has pages 1${g} (${b} is out of bounds)`);if(t=isFinite(b)?[t[b]]:w||"pdf"==i?t:t.slice(-1),void 0===n)n=.92;else if("number"!=typeof n||!isFinite(n)||n<0||n>1)throw new TypeError("The quality option must be an number in the 0.01.0 range");if(void 0===o){let t=(r||ur(e,f)).match(/@(\d+)x$/i);o=t?parseInt(t[1],10):1}else if("number"!=typeof o||!Number.isInteger(o)||o<1)throw new TypeError("The density option must be a non-negative integer");return void 0===h?h=!0:"svg"==i&&(h=!!h),{filename:e,pattern:y,format:i,mime:d,pages:t,padding:m,quality:n,matte:a,density:o,outline:h,archive:c}}},vr=require("./index.node"),_r=u(Object.freeze({__proto__:null,default:vr}));const xr=t,{EventEmitter:kr}=e,{inspect:Er}=r,{sync:Ar,hasMagic:jr}=te(),Or=ee,Sr=Se,Cr=ar,Ir=br,Tr=Er.custom,Mr=Symbol.for(""),Lr=t=>(t||{})[Mr],Nr=(t,e)=>{let r=Dr(Object.create(t.prototype),Mr,e);return e&&Dr(r,"native",Rr[t.name])},Rr=Object.entries(_r).reduce(((t,[e,r])=>{let[i,s,n,a]=e.match(/(.*?)_(?:([sg]et)_)?(.*)/),o=t[s]||(t[s]={});return(n?o[a]||(o[a]={}):o)[n||a]=r,t}),{});class $r{constructor(t){Dr(this,"native",Rr[t.name])}alloc(...t){return this.init("new",...t)}init(t,...e){return Dr(this,Mr,this.native[t](null,...e))}ref(t,e){return arguments.length>1?this[Symbol.for(t)]=e:this[Symbol.for(t)]}prop(t,...e){let r=arguments.length>1?"set":"get";return this.native[t][r](this[Mr],...e)}""(t,...e){try{return this.native[t](this[Mr],...e)}catch(t){throw Error.captureStackTrace(t,this.),t}}}const qr=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!1,enumerable:!0}),Dr=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!1,enumerable:!1});const Br=t=>"string"==typeof t?t:new String(t).toString();function Pr(t){if(Array.isArray(t)&&6==t.length)var[e,r,i,s,n,a,o,h,c]=t.concat(0,0,1);else if(t instanceof Sr.DOMMatrix)var{a:e,b:r,c:i,d:s,e:n,f:a,m14:o,m24:h,m44:c}=t;return[e,i,n,r,s,a,o,h,c]}function zr(t){let[e,r,i,s,n,a,o,h,c]=t;return new Sr.DOMMatrix([e,s,0,o,r,n,0,h,0,0,1,0,i,a,0,c])}class Fr extends $r{#t;#e;constructor(){super(Fr),this.#t=!1,this.#e=60}get windows(){return[...Wr.windows]}get running(){return this.#t}get fps(){return this.#e}set fps(t){t>=1&&t!=this.#e&&(this.#e=this.("setRate",t))}launch(){if(this.#t)return console.error("Application is already running");this.#t=!0,clearTimeout(Wr.launcher),this.("launch",(t=>{let{ui:e,state:r,geom:i}=JSON.parse(t);for(const[t,{top:e,left:r}]of Object.entries(i||{}))Wr.getWindow(t,(t=>{t.left=t.left||r,t.top=t.top||e}));r&&(Wr.windows=Wr.windows.filter((t=>t.state.id in(r||{})&&Object.assign(t,r[t.state.id]))));for(const[t,r]of Object.entries(e||{}))Wr.getWindow(t,((t,e)=>{let i={};for(const[[e,s]]of r.map((t=>Object.entries(t))))switch(e){case"modifiers":let{ctrl:r,alt:n,logo:a,shift:o}=s;i={ctrlKey:r,altKey:n,metaKey:a,shiftKey:o};break;case"mouse":let{button:h,x:c,y:l,pageX:u,pageY:p}=s;s.events.forEach((e=>t.emit(e,{x:c,y:l,pageX:u,pageY:p,button:h,...i})));break;case"input":t.emit(e,{value:s,code:s.charCodeAt(),...i});break;case"keyboard":let{event:f,key:d,code:g,repeat:m}=s,w=!0;if(t.emit(f,{key:d,code:g,repeat:m,...i,preventDefault:()=>w=!1}),w&&"keydown"==f&&!m){let{ctrlKey:e,altKey:r,metaKey:s}=i;s&&"W"==d||e&&"C"==d||r&&"F4"==d?t.close():(s&&"F"==d||r&&"F8"==d)&&(t.fullscreen=!t.fullscreen)}break;case"focus":s?t.emit("focus"):t.emit("blur");break;case"resize":"resize"==t.fit&&(t.ctx.prop("size",s.width,s.height),t.canvas.prop("width",s.width),t.canvas.prop("height",s.height)),t.emit(e,s);break;case"move":case"wheel":t.emit(e,s);break;case"fullscreen":t.emit(e,{enabled:s});break;default:console.log(e,s)}}));return Wr.nextFrame(((t,e)=>{0==e&&t.emit("setup"),t.emit("frame",{frame:e}),t.listenerCount("draw")&&(t.canvas.width=t.canvas.width,t.emit("draw",{frame:e}))})),this.("setRate",Wr.needsFrameUpdates()?this.#e:0),[JSON.stringify(Wr.windows.map((t=>t.state))),Wr.windows.map((t=>Lr(t.canvas.pages[t.page-1])))]})),Wr.windows=[]}quit(){this.("quit")}}class Ur extends kr{static#r="left,top,width,height,title,page,background,fullscreen,cursor,fit,visible".split(/,/);#i;#s;constructor(t=512,e=512,r={}){Number.isFinite(t)&&Number.isFinite(e)||(t=(r=[...arguments].slice(-1)[0]||{}).width||(r.canvas||{}).width||512,e=r.height||(r.canvas||{}).height||512);let i=r.canvas instanceof Gr?r.canvas:new Gr(t,e);super(Ur),this.#s={title:"",visible:!0,background:"white",fullscreen:!1,page:i.pages.length,left:void 0,top:void 0,width:t,height:e,cursor:"default",cursorHidden:!1,fit:"contain",id:Math.random().toString(16)},Object.assign(this,{canvas:i},Object.fromEntries(Object.entries(r).filter((([t,e])=>Ur.#r.includes(t)&&void 0!==e)))),Wr.openWindow(this)}get state(){return this.#s}get ctx(){return this.#i.pages[this.page-1]}get canvas(){return this.#i}set canvas(t){t instanceof Gr&&(t.getContext("2d"),this.#i=t,this.#s.page=t.pages.length)}get visible(){return this.#s.visible}set visible(t){this.#s.visible=!!t}get fullscreen(){return this.#s.fullscreen}set fullscreen(t){this.#s.fullscreen=!!t}get title(){return this.#s.title}set title(t){this.#s.title=(null!=t?t:"").toString()}get cursor(){return this.#s.cursorHidden?"none":this.#s.cursor}set cursor(t){Cr.cursor(t)&&(this.#s.cursorHidden="none"==t,"none"!=t&&(this.#s.cursor=t))}get fit(){return this.#s.fit}set fit(t){Cr.fit(t)&&(this.#s.fit=t)}get left(){return this.#s.left}set left(t){Number.isFinite(t)&&(this.#s.left=t)}get top(){return this.#s.top}set top(t){Number.isFinite(t)&&(this.#s.top=t)}get width(){return this.#s.width}set width(t){Number.isFinite(t)&&(this.#s.width=t)}get height(){return this.#s.height}set height(t){Number.isFinite(t)&&(this.#s.height=t)}get page(){return this.#s.page}set page(t){t<0&&(t+=this.#i.pages.length+1);let e=this.#i.pages[t-1];if(e&&this.#s.page!=t){let[r,i]=e.prop("size");this.#i.prop("width",r),this.#i.prop("height",i),this.#s.page=t}}get background(){return this.#s.background}set background(t){this.#s.background=(null!=t?t:"").toString()}emit(t,e){try{super.emit(t,Object.assign({target:this,type:t},e))}catch(t){console.error(t)}}close(){Wr.closeWindow(this)}[Tr](t,e){let r=Object.fromEntries(Ur.#r.map((t=>[t,this.#s[t]])));return`Window ${Er(r,e)}`}}const Wr={App:new Fr,windows:[],frames:new WeakMap,launcher:null,nextFrame(t){Wr.windows.forEach((e=>{let r=Wr.frames.get(e)||0;Wr.frames.set(e,r+1),t(e,r)}))},needsFrameUpdates(){let t=Wr.windows.map((t=>t.eventNames())).flat();return t.includes("frame")||t.includes("draw")},getWindow(t,e){Wr.windows.filter((e=>e.state.id==t)).forEach((t=>e(t)))},openWindow(t){Wr.windows.push(t),Wr.launcher||(Wr.launcher=setTimeout((()=>Wr.App.launch()))),Rr.App.openWindow(JSON.stringify(t.state),Lr(t.canvas.pages[t.state.page-1]))},closeWindow(t){Wr.windows=Wr.windows.filter((e=>e!==t)),Rr.App.closeWindow(t.state.id)}};class Gr extends $r{#n;constructor(t,e){super(Gr).alloc(),this.#n=[],Object.assign(this,{width:t,height:e})}getContext(t){return"2d"==t?this.#n[0]||this.newPage():null}get gpu(){return"gpu"==this.prop("engine")}set gpu(t){this.prop("engine",t?"gpu":"cpu")}get width(){return this.prop("width")}set width(t){this.prop("width","number"==typeof t&&!Number.isNaN(t)&&t>=0?t:300),this.#n[0]&&this.getContext("2d").("resetSize",Lr(this))}get height(){return this.prop("height")}set height(t){this.prop("height",t="number"==typeof t&&!Number.isNaN(t)&&t>=0?t:150),this.#n[0]&&this.getContext("2d").("resetSize",Lr(this))}newPage(t,e){let r=new Kr(this);return this.#n.unshift(r),2==arguments.length&&Object.assign(this,{width:t,height:e}),r}get pages(){return this.#n.slice().reverse()}get png(){return this.toBuffer("png")}get jpg(){return this.toBuffer("jpg")}get pdf(){return this.toBuffer("pdf")}get svg(){return this.toBuffer("svg")}get async(){return this.prop("async")}set async(t){t||process.emitWarning("Use the saveAsSync, toBufferSync, and toDataURLSync methods instead of setting the Canvas `async` property to false","DeprecationWarning"),this.prop("async",t)}saveAs(t,e={}){if(!this.async)return this.saveAsSync(...arguments);e="number"==typeof e?{quality:e}:e;let{format:r,quality:i,pages:s,padding:n,pattern:a,density:o,outline:h,matte:c}=Ir.options(this.pages,{filename:t,...e}),l=[s.map(Lr),a,n,r,i,o,h,c];return this.("save",...l)}saveAsSync(t,e={}){e="number"==typeof e?{quality:e}:e;let{format:r,quality:i,pages:s,padding:n,pattern:a,density:o,outline:h,matte:c}=Ir.options(this.pages,{filename:t,...e});this.("saveSync",s.map(Lr),a,n,r,i,o,h,c)}toBuffer(t="png",e={}){if(!this.async)return this.toBufferSync(...arguments);e="number"==typeof e?{quality:e}:e;let{format:r,quality:i,pages:s,density:n,outline:a,matte:o}=Ir.options(this.pages,{extension:t,...e}),h=[s.map(Lr),r,i,n,a,o];return this.("toBuffer",...h)}toBufferSync(t="png",e={}){e="number"==typeof e?{quality:e}:e;let{format:r,quality:i,pages:s,density:n,outline:a,matte:o}=Ir.options(this.pages,{extension:t,...e});return this.("toBufferSync",s.map(Lr),r,i,n,a,o)}toDataURL(t="png",e={}){if(!this.async)return this.toDataURLSync(...arguments);e="number"==typeof e?{quality:e}:e;let{mime:r}=Ir.options(this.pages,{extension:t,...e});return this.toBuffer(t,e).then((t=>`data:${r};base64,${t.toString("base64")}`))}toDataURLSync(t="png",e={}){e="number"==typeof e?{quality:e}:e;let{mime:r}=Ir.options(this.pages,{extension:t,...e});return`data:${r};base64,${this.toBufferSync(t,e).toString("base64")}`}[Tr](t,e){let{width:r,height:i,async:s,gpu:n,pages:a}=this;return`Canvas ${Er({width:r,height:i,async:s,gpu:n,pages:a},e)}`}}class Qr extends $r{constructor(t,...e){if(super(Qr),t=(t||"").toLowerCase(),!["linear","radial","conic"].includes(t))throw new Error('Function is not a constructor (use CanvasRenderingContext2D\'s "createConicGradient", "createLinearGradient", and "createRadialGradient" methods instead)');this.init(t,...e)}addColorStop(t,e){if(!(t>=0&&t<=1))throw new Error("Color stop offsets must be between 0.0 and 1.0");this.("addColorStop",t,e)}[Tr](t,e){return`CanvasGradient (${this.("repr")})`}}class Hr extends $r{constructor(t,e){if(super(Hr),t instanceof Xr)this.init("from_image",Lr(t),e);else{if(!(t instanceof Gr))throw new Error("CanvasPatterns require a source Image or a Canvas");{let r=t.getContext("2d");this.init("from_canvas",Lr(r),e)}}}setTransform(t){arguments.length>1&&(t=[...arguments]),this.("setTransform",Pr(t))}[Tr](t,e){return`CanvasPattern (${this.("repr")})`}}class Jr extends $r{constructor(t,{path:e,line:r,color:i,angle:s,offset:n=0}={}){super(Jr);let[a,o]="number"==typeof n?[n,n]:n.slice(0,2),[h,c]="number"==typeof t?[t,t]:t.slice(0,2);e=Lr(e),r=null!=r?r:e?0:1,s=null!=s?s:e?0:-Math.PI/4,this.alloc(e,i,r,s,h,c,a,o)}[Tr](t,e){return`CanvasTexture (${this.("repr")})`}}class Kr extends $r{#i;constructor(t){try{super(Kr).alloc(Lr(t)),this.#i=new WeakRef(t)}catch(t){throw new TypeError('Function is not a constructor (use Canvas\'s "getContext" method instead)')}}get canvas(){return this.#i.deref()}reset(){this.("reset")}save(){this.("save")}restore(){this.("restore")}get currentTransform(){return zr(this.prop("currentTransform"))}set currentTransform(t){this.prop("currentTransform",Pr(t))}resetTransform(){this.("resetTransform")}getTransform(){return this.currentTransform}setTransform(t){this.currentTransform=arguments.length>1?[...arguments]:t}transform(t,e,r,i,s,n){this.("transform",...arguments)}translate(t,e){this.("translate",...arguments)}scale(t,e){this.("scale",...arguments)}rotate(t){this.("rotate",...arguments)}createProjection(t,e){return zr(this.("createProjection",[t].flat(),[e].flat()))}beginPath(){this.("beginPath")}rect(t,e,r,i){this.("rect",...arguments)}arc(t,e,r,i,s,n){this.("arc",...arguments)}ellipse(t,e,r,i,s,n,a,o){this.("ellipse",...arguments)}moveTo(t,e){this.("moveTo",...arguments)}lineTo(t,e){this.("lineTo",...arguments)}arcTo(t,e,r,i,s){this.("arcTo",...arguments)}bezierCurveTo(t,e,r,i,s,n){this.("bezierCurveTo",...arguments)}quadraticCurveTo(t,e,r,i){this.("quadraticCurveTo",...arguments)}conicCurveTo(t,e,r,i,s){this.("conicCurveTo",...arguments)}closePath(){this.("closePath")}isPointInPath(t,e){return this.("isPointInPath",...arguments)}isPointInStroke(t,e){return this.("isPointInStroke",...arguments)}roundRect(t,e,r,i,s){let n=Cr.radii(s);n&&(r<0&&(n=[n[1],n[0],n[3],n[2]]),i<0&&(n=[n[3],n[2],n[1],n[0]]),this.("roundRect",t,e,r,i,...n.map((({x:t,y:e})=>[t,e])).flat()))}fill(t,e){t instanceof ti?this.("fill",Lr(t),e):this.("fill",t)}stroke(t,e){t instanceof ti?this.("stroke",Lr(t),e):this.("stroke",t)}clip(t,e){t instanceof ti?this.("clip",Lr(t),e):this.("clip",t)}createPattern(t,e){return new Hr(...arguments)}createLinearGradient(t,e,r,i){return new Qr("Linear",...arguments)}createRadialGradient(t,e,r,i,s,n){return new Qr("Radial",...arguments)}createConicGradient(t,e,r){return new Qr("Conic",...arguments)}createTexture(t,e){return new Jr(t,e)}fillRect(t,e,r,i){this.("fillRect",...arguments)}strokeRect(t,e,r,i){this.("strokeRect",...arguments)}clearRect(t,e,r,i){this.("clearRect",...arguments)}set fillStyle(t){let e=t instanceof Hr||t instanceof Qr||t instanceof Jr,[r,i]=e?[t,Lr(t)]:[null,t];this.ref("fill",r),this.prop("fillStyle",i)}get fillStyle(){let t=this.prop("fillStyle");return null===t?this.ref("fill"):t}set strokeStyle(t){let e=t instanceof Hr||t instanceof Qr||t instanceof Jr,[r,i]=e?[t,Lr(t)]:[null,t];this.ref("stroke",r),this.prop("strokeStyle",i)}get strokeStyle(){let t=this.prop("strokeStyle");return null===t?this.ref("stroke"):t}getLineDash(){return this.("getLineDash")}setLineDash(t){this.("setLineDash",t)}get lineCap(){return this.prop("lineCap")}set lineCap(t){this.prop("lineCap",t)}get lineDashFit(){return this.prop("lineDashFit")}set lineDashFit(t){this.prop("lineDashFit",t)}get lineDashMarker(){return Nr(ti,this.prop("lineDashMarker"))}set lineDashMarker(t){this.prop("lineDashMarker",t instanceof ti?Lr(t):t)}get lineDashOffset(){return this.prop("lineDashOffset")}set lineDashOffset(t){this.prop("lineDashOffset",t)}get lineJoin(){return this.prop("lineJoin")}set lineJoin(t){this.prop("lineJoin",t)}get lineWidth(){return this.prop("lineWidth")}set lineWidth(t){this.prop("lineWidth",t)}get miterLimit(){return this.prop("miterLimit")}set miterLimit(t){this.prop("miterLimit",t)}get imageSmoothingEnabled(){return this.prop("imageSmoothingEnabled")}set imageSmoothingEnabled(t){this.prop("imageSmoothingEnabled",!!t)}get imageSmoothingQuality(){return this.prop("imageSmoothingQuality")}set imageSmoothingQuality(t){this.prop("imageSmoothingQuality",t)}putImageData(t,...e){this.("putImageData",t,...e)}createImageData(t,e){return new Zr(t,e)}getImageData(t,e,r,i){let s=Math.floor(r),n=Math.floor(i),a=this.("getImageData",t,e,s,n);return new Zr(a,s,n)}drawImage(t,...e){if(t instanceof Gr)this.("drawImage",Lr(t.getContext("2d")),...e);else{if(!(t instanceof Xr))throw new Error("Expected an Image or a Canvas argument");this.("drawImage",Lr(t),...e)}}drawCanvas(t,...e){t instanceof Gr?this.("drawCanvas",Lr(t.getContext("2d")),...e):this.drawImage(t,...e)}get font(){return this.prop("font")}set font(t){this.prop("font",Cr.font(t))}get textAlign(){return this.prop("textAlign")}set textAlign(t){this.prop("textAlign",t)}get textBaseline(){return this.prop("textBaseline")}set textBaseline(t){this.prop("textBaseline",t)}get direction(){return this.prop("direction")}set direction(t){this.prop("direction",t)}measureText(t,e){t=this.textWrap?t:t+"";let[r,...i]=this.("measureText",Br(t),e);return new ei(r,i)}fillText(t,e,r,i){this.("fillText",Br(t),e,r,i)}strokeText(t,e,r,i){this.("strokeText",Br(t),e,r,i)}outlineText(t){let e=this.("outlineText",Br(t));return e?Nr(ti,e):null}get fontVariant(){return this.prop("fontVariant")}set fontVariant(t){this.prop("fontVariant",Cr.variant(t))}get textTracking(){return this.prop("textTracking")}set textTracking(t){this.prop("textTracking",t)}get textWrap(){return this.prop("textWrap")}set textWrap(t){this.prop("textWrap",!!t)}get globalCompositeOperation(){return this.prop("globalCompositeOperation")}set globalCompositeOperation(t){this.prop("globalCompositeOperation",t)}get globalAlpha(){return this.prop("globalAlpha")}set globalAlpha(t){this.prop("globalAlpha",t)}get shadowBlur(){return this.prop("shadowBlur")}set shadowBlur(t){this.prop("shadowBlur",t)}get shadowColor(){return this.prop("shadowColor")}set shadowColor(t){this.prop("shadowColor",t)}get shadowOffsetX(){return this.prop("shadowOffsetX")}set shadowOffsetX(t){this.prop("shadowOffsetX",t)}get shadowOffsetY(){return this.prop("shadowOffsetY")}set shadowOffsetY(t){this.prop("shadowOffsetY",t)}get filter(){return this.prop("filter")}set filter(t){this.prop("filter",Cr.filter(t))}[Tr](t,e){let r=["canvas","currentTransform","fillStyle","strokeStyle","font","fontVariant","direction","textAlign","textBaseline","textTracking","textWrap","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","filter","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit"],i={};if(t>0)for(var s of r)try{i[s]=this[s]}catch{i[s]=void 0}return`CanvasRenderingContext2D ${Er(i,e)}`}}const Vr=t=>[t].flat(2).map((t=>jr(t)?Ar(t):t)).flat();class Yr extends $r{constructor(){super(Yr)}get families(){return this.prop("families")}has(t){return this.("has",t)}family(t){return this.("family",t)}use(...t){let e=function(t){return t.map((t=>Array.isArray(t)?"a":{string:"s",number:"n",object:"o"}[typeof t]||"x")).join("")}(t);if("o"==e){let e={};for(let[r,i]of Object.entries(t.shift()))e[r]=this.("addFamily",r,Vr(i));return e}if(e.match(/^s?[as]$/)){let e=Vr(t.pop()),r=t.shift();return this.("addFamily",r,e)}throw new Error("Expected an array of file paths or an object mapping family names to font files")}reset(){return this.("reset")}}class Xr extends $r{constructor(){super(Xr).alloc()}get complete(){return this.prop("complete")}get height(){return this.prop("height")}get width(){return this.prop("width")}get src(){return this.prop("src")}set src(t){var e,r=()=>{},i=t=>a.emit("ok",t),s=t=>a.emit("err",t),n=t=>e=>{(t||r)(e),delete this._fetch};this._fetch&&this._fetch.removeAllListeners();let a=this._fetch=(new kr).once("ok",n(this.onload)).once("err",n(this.onerror));if(Buffer.isBuffer(t))[e,t]=[t,""];else{if("string"!=typeof t)return;if(/^\s*data:/.test(t)){let r=t.indexOf(","),i=-1!==t.lastIndexOf("base64",r)?"base64":"utf8",s=t.slice(r+1);e=Buffer.from(s,i)}else/^\s*https?:\/\//.test(t)?Or.concat(t,((e,r,n)=>{let a=(r||{}).statusCode;e?s(e):a<200||a>=300?s(new Error(`Failed to load image from "${t}" (error ${a})`)):this.prop("data",n)?i(this):s(new Error("Could not decode image data"))})):e=xr.readFileSync(t)}this.prop("src",t),e&&(this.prop("data",e)?i(this):s(new Error("Could not decode image data")))}decode(){return this._fetch?new Promise(((t,e)=>this._fetch.once("ok",t).once("err",e))):this.complete?Promise.resolve(this):Promise.reject(new Error("Missing Source URL"))}[Tr](t,e){let{width:r,height:i,complete:s,src:n}=this;return e.maxStringLength=n.match(/^data:/)?128:1/0,`Image ${Er({width:r,height:i,complete:s,src:n},e)}`}}class Zr{constructor(...t){if(t[0]instanceof Zr)var{data:e,width:r,height:i}=t[0];else if(t[0]instanceof Uint8ClampedArray||t[0]instanceof Buffer){var[e,r,i]=t;if(i=i||e.length/r/4,e.length/4!=r*i)throw new Error("ImageData dimensions must match buffer length")}else var[r,i]=t;if(!Number.isInteger(r)||!Number.isInteger(i)||r<0||i<0)throw new Error("ImageData dimensions must be positive integers");qr(this,"width",r),qr(this,"height",i),qr(this,"data",new Uint8ClampedArray(e&&e.buffer||r*i*4))}[Tr](t,e){let{width:r,height:i,data:s}=this;return`ImageData ${Er({width:r,height:i,data:s},e)}`}}class ti extends $r{static op(t,e,r){return Nr(ti,e.("op",Lr(r),t))}static interpolate(t,e,r){return Nr(ti,t.("interpolate",Lr(e),r))}static effect(t,e,...r){return Nr(ti,e.(t,...r))}constructor(t){super(ti),t instanceof ti?this.init("from_path",Lr(t)):"string"==typeof t?this.init("from_svg",t):this.alloc()}get bounds(){return this.("bounds")}get edges(){return this.("edges")}get d(){return this.prop("d")}set d(t){return this.prop("d",t)}contains(t,e){return this.("contains",t,e)}points(t=1){return this.jitter(t,0).edges.map((([t,...e])=>e.slice(-2))).filter((t=>t.length))}addPath(t,e){if(!(t instanceof ti))throw new Error("Expected a Path2D object");e&&(e=Pr(e)),this.("addPath",Lr(t),e)}moveTo(t,e){this.("moveTo",...arguments)}lineTo(t,e){this.("lineTo",...arguments)}closePath(){this.("closePath")}arcTo(t,e,r,i,s){this.("arcTo",...arguments)}bezierCurveTo(t,e,r,i,s,n){this.("bezierCurveTo",...arguments)}quadraticCurveTo(t,e,r,i){this.("quadraticCurveTo",...arguments)}conicCurveTo(t,e,r,i,s){this.("conicCurveTo",...arguments)}ellipse(t,e,r,i,s,n,a,o){this.("ellipse",...arguments)}rect(t,e,r,i){this.("rect",...arguments)}arc(t,e,r,i,s){this.("arc",...arguments)}roundRect(t,e,r,i,s){let n=Cr.radii(s);n&&(r<0&&(n=[n[1],n[0],n[3],n[2]]),i<0&&(n=[n[3],n[2],n[1],n[0]]),this.("roundRect",t,e,r,i,...n.map((({x:t,y:e})=>[t,e])).flat()))}interpolate(t,e){return ti.interpolate(this,t,e)}complement(t){return ti.op("complement",this,t)}difference(t){return ti.op("difference",this,t)}intersect(t){return ti.op("intersect",this,t)}union(t){return ti.op("union",this,t)}xor(t){return ti.op("xor",this,t)}jitter(t,e,r){return ti.effect("jitter",this,...arguments)}simplify(t){return ti.effect("simplify",this,t)}unwind(){return ti.effect("unwind",this)}round(t){return ti.effect("round",this,t)}offset(t,e){return ti.effect("offset",this,t,e)}transform(t){let e=arguments.length>1?[...arguments]:t;return ti.effect("transform",this,Pr(e))}trim(...t){return"number"!=typeof t[1]&&(t[0]>0?t.unshift(0):t[0]<0&&t.splice(1,0,1)),t[0]<0&&(t[0]=Math.max(-1,t[0])+1),t[1]<0&&(t[1]=Math.max(-1,t[1])+1),ti.effect("trim",this,...t)}[Tr](t,e){let{d:r,bounds:i,edges:s}=this;return`Path2D ${Er({d:r,bounds:i,edges:s},e)}`}}class ei{constructor([t,e,r,i,s,n,a,o,h,c,l,u],p){qr(this,"width",t),qr(this,"actualBoundingBoxLeft",e),qr(this,"actualBoundingBoxRight",r),qr(this,"actualBoundingBoxAscent",i),qr(this,"actualBoundingBoxDescent",s),qr(this,"fontBoundingBoxAscent",n),qr(this,"fontBoundingBoxDescent",a),qr(this,"emHeightAscent",o),qr(this,"emHeightDescent",h),qr(this,"hangingBaseline",c),qr(this,"alphabeticBaseline",l),qr(this,"ideographicBaseline",u),qr(this,"lines",p.map((([t,e,r,i,s,n,a])=>({x:t,y:e,width:r,height:i,baseline:s,startIndex:n,endIndex:a}))))}}var ri={Canvas:Gr,CanvasGradient:Qr,CanvasPattern:Hr,CanvasRenderingContext2D:Kr,CanvasTexture:Jr,TextMetrics:ei,Image:Xr,ImageData:Zr,Path2D:ti,Window:Ur,loadImage:t=>Object.assign(new Xr,{src:t}).decode(),...Sr,FontLibrary:new Yr,App:Wr.App};var ii=l(new class{grayscale(t){for(let e=0;e<t.data.length;e+=4){const r=.299*t.data[e]+.587*t.data[e+1]+.114*t.data[e+2];t.data.fill(r,e,e+3)}return t}threshold(t,e){for(let r=0;r<t.data.length;r+=4){const i=.299*t.data[r]+.587*t.data[r+1]+.114*t.data[r+2]<e?0:255;t.data.fill(i,r,r+3)}return t}bayer(t,e){const r=[[15,135,45,165],[195,75,225,105],[60,180,30,150],[240,120,210,90]];for(let i=0;i<t.data.length;i+=4){const s=.299*t.data[i]+.587*t.data[i+1]+.114*t.data[i+2],n=i/4%t.width,a=Math.floor(i/4/t.width),o=Math.floor((s+r[n%4][a%4])/2)<e?0:255;t.data.fill(o,i,i+3)}return t}floydsteinberg(t){const e=t.width,r=new Uint8ClampedArray(t.width*t.height);for(let e=0,i=0;i<t.data.length;e++,i+=4)r[e]=.299*t.data[i]+.587*t.data[i+1]+.114*t.data[i+2];for(let i=0,s=0;s<t.data.length;i++,s+=4){const n=r[i]<129?0:255,a=Math.floor((r[i]-n)/16);t.data.fill(n,s,s+3),r[i+1]+=7*a,r[i+e-1]+=3*a,r[i+e]+=5*a,r[i+e+1]+=1*a}return t}atkinson(t){const e=t.width,r=new Uint8ClampedArray(t.width*t.height);for(let e=0,i=0;i<t.data.length;e++,i+=4)r[e]=.299*t.data[i]+.587*t.data[i+1]+.114*t.data[i+2];for(let i=0,s=0;s<t.data.length;i++,s+=4){const n=r[i]<129?0:255,a=Math.floor((r[i]-n)/8);t.data.fill(n,s,s+3),r[i+1]+=a,r[i+2]+=a,r[i+e-1]+=a,r[i+e]+=a,r[i+e+1]+=a,r[i+2*e]+=a}return t}});var si=l(new class{flatten(t,e){for(let r=0;r<t.data.length;r+=4){const i=t.data[r+3],s=255-i;t.data[r]=(i*t.data[r]+s*e[0])/255,t.data[r+1]=(i*t.data[r+1]+s*e[1])/255,t.data[r+2]=(i*t.data[r+2]+s*e[2])/255,t.data[r+3]=255}return t}});const ni={cp437:{name:"USA, Standard Europe",languages:["en"],offset:128,chars:""},cp720:{name:"Arabic",languages:["ar"],offset:128,chars:""},cp737:{name:"Greek",languages:["el"],offset:128,chars:" "},cp775:{name:"Baltic Rim",languages:["et","lt"],offset:128,chars:""},cp850:{name:"Multilingual",languages:["en"],offset:128,chars:" "},cp851:{name:"Greek",languages:["el"],offset:128,chars:" "},cp852:{name:"Latin 2",languages:["hu","pl","cz"],offset:128,chars:""},cp853:{name:"Turkish",languages:["tr"],offset:128,chars:""},cp855:{name:"Cyrillic",languages:["bg"],offset:128,chars:" "},cp857:{name:"Turkish",languages:["tr"],offset:128,chars:" "},cp858:{name:"Euro",languages:["en"],offset:128,chars:" "},cp860:{name:"Portuguese",languages:["pt"],offset:128,chars:" "},cp861:{name:"Icelandic",languages:["is"],offset:128,chars:" "},cp862:{name:"Hebrew",languages:["he"],offset:128,chars:" "},cp863:{name:"Canadian French",languages:["fr"],offset:128,chars:" "},cp864:{name:"Arabic",languages:["ar"],offset:0,chars:"\0\b\t\n\v\f\r !\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ "},cp865:{name:"Nordic",languages:["sv","dk"],offset:128,chars:" "},cp866:{name:"Cyrillic 2",languages:["ru"],offset:128,chars:" "},cp869:{name:"Greek",languages:["el"],offset:128,chars:" "},cp874:{name:"Thai",languages:["th"],offset:128,chars:""},cp1098:{name:"Farsi",languages:["fa"],offset:128,chars:"   "},cp1118:{name:"Lithuanian",languages:["lt"],offset:128,chars:""},cp1119:{name:"Lithuanian",languages:["lt"],offset:128,chars:""},cp1125:{name:"Ukrainian",languages:["uk"],offset:128,chars:" "},cp1162:{name:"Thai",languages:["th"],offset:128,chars:""},cp2001:{name:"Lithuanian KBL or 771",languages:["lt"],offset:128,chars:""},cp3001:{name:"Estonian 1 or 1116",languages:["et"],offset:128,chars:""},cp3002:{name:"Estonian 2",languages:["et"],offset:128,chars:" "},cp3011:{name:"Latvian 1",languages:["lv"],offset:128,chars:""},cp3012:{name:"Latvian 2 (modified 866)",languages:["lv"],offset:128,chars:""},cp3021:{name:"Bulgarian (MIK)",languages:["bg"],offset:128,chars:" "},cp3041:{name:"Maltese ISO 646",languages:["mt"],offset:0,chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ^_abcdefghijklmnopqrstuvwxyz"},cp3840:{name:"Russian (modified 866)",languages:["ru"],offset:128,chars:""},cp3841:{name:"Ghost",languages:["ru"],offset:128,chars:" !\"#$%&'()*+,-./0123456789:;<=>?"},cp3843:{name:"Polish (Mazovia)",languages:["pl"],offset:128,chars:""},cp3844:{name:"Czech (Kamenick)",languages:["cz"],offset:128,chars:""},cp3845:{name:"Hungarian (CWI-2)",languages:["hu"],offset:128,chars:""},cp3846:{name:"Turkish",languages:["tr"],offset:128,chars:""},cp3847:{name:"Brazil ABNT",languages:["pt"],offset:256,chars:""},cp3848:{name:"Brazil ABICOMP",languages:["pt"],offset:160,chars:""},iso88591:{name:"Latin 1",languages:["en"],offset:128,chars:""},iso88592:{name:"Latin 2",languages:["hu","pl","cz"],offset:128,chars:""},iso88597:{name:"Greek",languages:["el"],offset:128,chars:""},iso885915:{name:"Latin 9",languages:["fr"],offset:128,chars:""},rk1048:{name:"Kazakh",languages:["kk"],offset:128,chars:""},windows1250:{name:"Latin 2",languages:["hu","pl","cz"],offset:128,chars:""},windows1251:{name:"Cyrillic",languages:["ru"],offset:128,chars:""},windows1252:{name:"Latin",languages:["fr"],offset:128,chars:""},windows1253:{name:"Greek",languages:["el"],offset:128,chars:""},windows1254:{name:"Turkish",languages:["tr"],offset:128,chars:""},windows1255:{name:"Hebrew",languages:["he"],offset:128,chars:""},windows1256:{name:"Arabic",languages:["ar"],offset:128,chars:""},windows1257:{name:"Baltic Rim",languages:["et","lt"],offset:128,chars:""},windows1258:{name:"Vietnamese",languages:["vi"],offset:128,chars:""}},ai={en:"The quick brown fox jumps over the lazy dog.",jp:"   ",pt:"O prximo vo  noite sobre o Atlntico, pe freqentemente o nico mdico.",fr:"Les nafs githales htifs pondant  Nol o il gle sont srs d'tre dus en voyant leurs drles d'ufs abms.",sv:"Flygande bckasiner ska strax hwila p mjuka tuvor.",dk:"Quizdeltagerne spiste jordbr med flde",el:"   ",tr:"Pijamal hasta, yaz ofre abucak gvendi.",ru:"         ",hu:"rvztr tkrfrgp",pl:"Pchn w t d jea lub om skrzy fig",cz:"Mohu jst sklo, neubl mi.",ar:"        .",et:"Ma vin klaasi sa, see ei tee mulle midagi.",lt:"A galiu valgyti stikl ir jis mans neeidia.",bg:"   ,    .",is:"g get eti gler n ess a meia mig.",he:"       .",fa:".       ",uk:"   ,     .",vi:"Ti c th n thy tinh m khng hi g.",kk:"",lv:"Es varu st stiklu, tas man nekait.",mt:"Nista' niekol il-ie u ma jagmilli xejn.",th:" "};class oi{static getEncodings(){return Object.keys(ni)}static getTestStrings(t){return void 0!==ni[t]&&void 0!==ni[t].languages?ni[t].languages.map((t=>({language:t,string:ai[t]}))):[]}static supports(t){return void 0!==ni[t]&&void 0!==ni[t].chars}static encode(t,e){const r=new Uint8Array(t.length);let i="\0".repeat(128),s=128;void 0!==ni[e]&&void 0!==ni[e].chars&&(i=ni[e].chars,s=ni[e].offset);for(let e=0;e<t.length;e++){const n=t.codePointAt(e);if(n<128)r[e]=n;else{const a=i.indexOf(t[e]);-1!==a?r[e]=s+a:n<256&&(n<s||n>=s+i.length)?r[e]=n:r[e]=63}}return r}static autoEncode(t,e){const r=[];let i,s=-1;for(let n=0;n<t.length;n++){const a=t.codePointAt(n);let o,h=0;if(a<128&&(o=i||e[0],h=a),!o&&i){const e=ni[i].chars.indexOf(t[n]);-1!==e&&(o=i,h=ni[i].offset+e)}if(!o)for(let r=0;r<e.length;r++){const i=ni[e[r]].chars.indexOf(t[n]);if(-1!==i){o=e[r],h=ni[e[r]].offset+i;break}}o||(o=i||e[0],h=63),i!=o&&(i&&(r[s].bytes=new Uint8Array(r[s].bytes)),s++,r[s]={codepage:o,bytes:[]},i=o),r[s].bytes.push(h)}return i&&(r[s].bytes=new Uint8Array(r[s].bytes)),r}}const hi={epson:{cp437:0,shiftjis:1,cp850:2,cp860:3,cp863:4,cp865:5,cp851:11,cp853:12,cp857:13,cp737:14,iso88597:15,windows1252:16,cp866:17,cp852:18,cp858:19,cp720:32,cp775:33,cp855:34,cp861:35,cp862:36,cp864:37,cp869:38,iso88592:39,iso885915:40,cp1098:41,cp1118:42,cp1119:43,cp1125:44,windows1250:45,windows1251:46,windows1253:47,windows1254:48,windows1255:49,windows1256:50,windows1257:51,windows1258:52,rk1048:53},zjiang:{cp437:0,shiftjis:1,cp850:2,cp860:3,cp863:4,cp865:5,windows1252:16,cp866:17,cp852:18,cp858:19,windows1255:32,cp861:56,cp855:60,cp857:61,cp862:62,cp864:63,cp737:64,cp851:65,cp869:66,cp1119:68,cp1118:69,windows1250:72,windows1251:73,cp3840:74,cp3843:76,cp3844:77,cp3845:78,cp3846:79,cp3847:80,cp3848:81,cp2001:83,cp3001:84,cp3002:85,cp3011:86,cp3012:87,cp3021:88,cp3041:89,windows1253:90,windows1254:91,windows1256:92,cp720:93,windows1258:94,cp775:95},bixolon:{cp437:0,shiftjis:1,cp850:2,cp860:3,cp863:4,cp865:5,cp851:11,cp858:19},star:{cp437:0,shiftjis:1,cp850:2,cp860:3,cp863:4,cp865:5,windows1252:16,cp866:17,cp852:18,cp858:19},citizen:{cp437:0,shiftjis:1,cp850:2,cp860:3,cp863:4,cp865:5,cp852:18,cp866:17,cp857:8,windows1252:16,cp858:19,cp864:40},legacy:{cp437:0,cp737:64,cp850:2,cp775:95,cp852:18,cp855:60,cp857:61,cp858:19,cp860:3,cp861:56,cp862:62,cp863:4,cp864:28,cp865:5,cp866:17,cp869:66,cp936:255,cp949:253,cp950:254,cp1252:16,iso88596:22,shiftjis:252,windows874:30,windows1250:72,windows1251:73,windows1252:71,windows1253:90,windows1254:91,windows1255:32,windows1256:92,windows1257:25,windows1258:94}};class ci{constructor(t){this._reset(t)}_reset(t){this._options=Object.assign({width:null,embedded:!1,wordWrap:!0,imageMode:"column",codepageMapping:"epson",codepageCandidates:["cp437","cp858","cp860","cp861","cp863","cp865","cp852","cp857","cp855","cp866","cp869"]},t),this._embedded=this._options.width&&this._options.embedded,this._buffer=[],this._queued=[],this._cursor=0,this._codepage="ascii",this._state={codepage:0,align:"left",bold:!1,italic:!1,underline:!1,invert:!1,width:1,height:1}}_encode(t){if("auto"!=this._codepage)return oi.encode(t,this._codepage);let e;e="string"==typeof this._options.codepageMapping?hi[this._options.codepageMapping]:this._options.codepageMapping;const r=oi.autoEncode(t,this._options.codepageCandidates);let i=0;for(let t=0;t<r.length;t++)i+=3+r[t].bytes.byteLength;const s=new Uint8Array(i);let n=0;for(let t=0;t<r.length;t++)s.set([27,116,e[r[t].codepage]],n),s.set(r[t].bytes,n+3),n+=3+r[t].bytes.byteLength,this._state.codepage=e[r[t].codepage];return s}_queue(t){t.forEach((t=>this._queued.push(t)))}_flush(){if(this._embedded){let t=this._options.width-this._cursor;if("left"==this._state.align&&this._queued.push(new Array(t).fill(32)),"center"==this._state.align){const e=t%2;t>>=1,t>0&&this._queued.push(new Array(t).fill(32)),t+e>0&&this._queued.unshift(new Array(t+e).fill(32))}"right"==this._state.align&&this._queued.unshift(new Array(t).fill(32))}this._buffer=this._buffer.concat(this._queued),this._queued=[],this._cursor=0}_wrap(t,e){if(e||this._options.wordWrap&&this._options.width){const r="-".repeat(this._cursor);return E(e||this._options.width,{lineBreak:"\n",whitespace:"all"})(r+t).substring(this._cursor).split("\n")}return[t]}_restoreState(){this.bold(this._state.bold),this.italic(this._state.italic),this.underline(this._state.underline),this.invert(this._state.invert),this._queue([27,116,this._state.codepage])}_getCodepageIdentifier(t){let e;return e="string"==typeof this._options.codepageMapping?hi[this._options.codepageMapping]:this._options.codepageMapping,e[t]}initialize(){return this._queue([27,64]),this._flush(),this}codepage(t){if("auto"===t)return this._codepage=t,this;if(!oi.supports(t))throw new Error("Unknown codepage");let e;if(e="string"==typeof this._options.codepageMapping?hi[this._options.codepageMapping]:this._options.codepageMapping,void 0===e[t])throw new Error("Codepage not supported by printer");return this._codepage=t,this._state.codepage=e[t],this._queue([27,116,e[t]]),this}text(t,e){const r=this._wrap(t,e);for(let t=0;t<r.length;t++){const e=this._encode(r[t]);this._queue([e]),this._cursor+=r[t].length*this._state.width,this._options.width&&!this._embedded&&(this._cursor=this._cursor%this._options.width),t<r.length-1&&this.newline()}return this}newline(){return this._flush(),this._queue([10,13]),this._embedded&&this._restoreState(),this}line(t,e){return this.text(t,e),this.newline(),this}underline(t){return void 0===t&&(t=!this._state.underline),this._state.underline=t,this._queue([27,45,Number(t)]),this}italic(t){return void 0===t&&(t=!this._state.italic),this._state.italic=t,this._queue([27,52,Number(t)]),this}bold(t){return void 0===t&&(t=!this._state.bold),this._state.bold=t,this._queue([27,69,Number(t)]),this}width(t){if(void 0===t&&(t=1),"number"!=typeof t)throw new Error("Width must be a number");if(t<1||t>8)throw new Error("Width must be between 1 and 8");return this._state.width=t,this._queue([29,33,this._state.height-1|this._state.width-1<<4]),this}height(t){if(void 0===t&&(t=1),"number"!=typeof t)throw new Error("Height must be a number");if(t<1||t>8)throw new Error("Height must be between 1 and 8");return this._state.height=t,this._queue([29,33,this._state.height-1|this._state.width-1<<4]),this}invert(t){return void 0===t&&(t=!this._state.invert),this._state.invert=t,this._queue([29,66,Number(t)]),this}size(t){return t="small"===t?1:0,this._queue([27,77,t]),this}align(t){const e={left:0,center:1,right:2};if(!(t in e))throw new Error("Unknown alignment");return this._state.align=t,this._embedded||this._queue([27,97,e[t]]),this}table(t,e){0!=this._cursor&&this.newline();for(let r=0;r<e.length;r++){const i=[];let s=0;for(let n=0;n<t.length;n++){const a=[];if("string"==typeof e[r][n]){const i=E(t[n].width,{lineBreak:"\n"})(e[r][n]).split("\n");for(let e=0;e<i.length;e++)"right"==t[n].align?a[e]=this._encode(i[e].padStart(t[n].width)):a[e]=this._encode(i[e].padEnd(t[n].width))}if("function"==typeof e[r][n]){const i=new ci(Object.assign({},this._options,{width:t[n].width,embedded:!0}));i._codepage=this._codepage,i.align(t[n].align),e[r][n](i);const s=i.encode();let o=[];for(let t=0;t<s.byteLength;t++)t<s.byteLength-1&&10===s[t]&&13===s[t+1]?(a.push(o),o=[],t++):o.push(s[t]);o.length&&a.push(o)}s=Math.max(s,a.length),i[n]=a}for(let e=0;e<t.length;e++)if(i[e].length<s)for(let r=i[e].length;r<s;r++){let r="top";void 0!==t[e].verticalAlign&&(r=t[e].verticalAlign),"bottom"==r?i[e].unshift(new Array(t[e].width).fill(32)):i[e].push(new Array(t[e].width).fill(32))}for(let e=0;e<s;e++){for(let r=0;r<t.length;r++)void 0!==t[r].marginLeft&&this.raw(new Array(t[r].marginLeft).fill(32)),this.raw(i[r][e]),void 0!==t[r].marginRight&&this.raw(new Array(t[r].marginRight).fill(32));this.newline()}}return this}rule(t){return t=Object.assign({style:"single",width:this._options.width||10},t||{}),this._queue([27,116,this._getCodepageIdentifier("cp437"),new Array(t.width).fill("double"===t.style?205:196)]),this._queue([27,116,this._state.codepage]),this.newline(),this}box(t,e){let r;r="double"==(t=Object.assign({style:"single",width:this._options.width||30,marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0},t||{})).style?[201,187,200,188,205,186]:[218,191,192,217,196,179],0!=this._cursor&&this.newline(),this._restoreState(),this._queue([27,116,this._getCodepageIdentifier("cp437")]),this._queue([new Array(t.marginLeft).fill(32),r[0],new Array(t.width-2).fill(r[4]),r[1],new Array(t.marginRight).fill(32)]),this.newline();const i=[];if("string"==typeof e){const r=E(t.width-2-t.paddingLeft-t.paddingRight,{lineBreak:"\n"})(e).split("\n");for(let e=0;e<r.length;e++)"right"==t.align?i[e]=this._encode(r[e].padStart(t.width-2-t.paddingLeft-t.paddingRight)):i[e]=this._encode(r[e].padEnd(t.width-2-t.paddingLeft-t.paddingRight))}if("function"==typeof e){const r=new ci(Object.assign({},this._options,{width:t.width-2-t.paddingLeft-t.paddingRight,embedded:!0}));r._codepage=this._codepage,r.align(t.align),e(r);const s=r.encode();let n=[];for(let t=0;t<s.byteLength;t++)t<s.byteLength-1&&10===s[t]&&13===s[t+1]?(i.push(n),n=[],t++):n.push(s[t]);n.length&&i.push(n)}for(let e=0;e<i.length;e++)this._queue([new Array(t.marginLeft).fill(32),r[5],new Array(t.paddingLeft).fill(32)]),this._queue([i[e]]),this._restoreState(),this._queue([27,116,this._getCodepageIdentifier("cp437")]),this._queue([new Array(t.paddingRight).fill(32),r[5],new Array(t.marginRight).fill(32)]),this.newline();return this._queue([new Array(t.marginLeft).fill(32),r[2],new Array(t.width-2).fill(r[4]),r[3],new Array(t.marginRight).fill(32)]),this._restoreState(),this.newline(),this}barcode(t,e,r){if(this._embedded)throw new Error("Barcodes are not supported in table cells or boxes");const i={upca:0,upce:1,ean13:2,ean8:3,code39:4,coda39:4,itf:5,codabar:6,code93:72,code128:73,"gs1-128":80,"gs1-databar-omni":81,"gs1-databar-truncated":82,"gs1-databar-limited":83,"gs1-databar-expanded":84,"code128-auto":85};if(!(e in i))throw new Error("Symbology not supported by printer");{const s=oi.encode(t,"ascii");0!=this._cursor&&this.newline(),this._queue([29,104,r,29,119,"code39"===e?2:3]),"code128"==e&&123!==s[0]?this._queue([29,107,i[e],s.length+2,123,66,s]):i[e]>64?this._queue([29,107,i[e],s.length,s]):this._queue([29,107,i[e],s,0])}return this._flush(),this}qrcode(t,e,r,i){if(this._embedded)throw new Error("QR codes are not supported in table cells or boxes");this._queue([10]);const s={1:49,2:50};if(void 0===e&&(e=2),!(e in s))throw new Error("Model must be 1 or 2");if(this._queue([29,40,107,4,0,49,65,s[e],0]),void 0===r&&(r=6),"number"!=typeof r)throw new Error("Size must be a number");if(r<1||r>8)throw new Error("Size must be between 1 and 8");this._queue([29,40,107,3,0,49,67,r]);const n={l:48,m:49,q:50,h:51};if(void 0===i&&(i="m"),!(i in n))throw new Error("Error level must be l, m, q or h");this._queue([29,40,107,3,0,49,69,n[i]]);const a=oi.encode(t,"iso88591"),o=a.length+3;return this._queue([29,40,107,o%255,o/255,49,80,48,a]),this._queue([29,40,107,3,0,49,81,48]),this._flush(),this}image(t,e,r,i,s){if(this._embedded)throw new Error("Images are not supported in table cells or boxes");if(e%8!=0)throw new Error("Width must be a multiple of 8");if(r%8!=0)throw new Error("Height must be a multiple of 8");void 0===i&&(i="threshold"),void 0===s&&(s=128);const n=new ri.Canvas(e,r).getContext("2d");n.drawImage(t,0,0,e,r);let a=n.getImageData(0,0,e,r);switch(a=si.flatten(a,[255,255,255]),i){case"threshold":a=ii.threshold(a,s);break;case"bayer":a=ii.bayer(a,s);break;case"floydsteinberg":a=ii.floydsteinberg(a);break;case"atkinson":a=ii.atkinson(a)}const o=(t,i)=>t<e&&i<r?a.data[4*(e*i+t)]>0?0:1:0,h=(t,e)=>{const r=new Uint8Array(t*e>>3);for(let i=0;i<e;i++)for(let e=0;e<t;e+=8)for(let s=0;s<8;s++)r[i*(t>>3)+(e>>3)]|=o(e+s,i)<<7-s;return r};return 0!=this._cursor&&this.newline(),"column"==this._options.imageMode&&(this._queue([27,51,36]),((t,e)=>{const r=[];for(let i=0;i<Math.ceil(e/24);i++){const e=new Uint8Array(3*t);for(let r=0;r<t;r++)for(let t=0;t<3;t++)for(let s=0;s<8;s++)e[3*r+t]|=o(r,24*i+s+8*t)<<7-s;r.push(e)}return r})(e,r).forEach((t=>{this._queue([27,42,33,255&e,e>>8&255,t,10])})),this._queue([27,50])),"raster"==this._options.imageMode&&this._queue([29,118,48,0,e>>3&255,e>>3>>8&255,255&r,r>>8&255,h(e,r)]),this._flush(),this}cut(t){if(this._embedded)throw new Error("Cut is not supported in table cells or boxes");let e=0;return"partial"==t&&(e=1),this._queue([29,86,e]),this}pulse(t,e,r){if(this._embedded)throw new Error("Pulse is not supported in table cells or boxes");return void 0===t&&(t=0),void 0===e&&(e=100),void 0===r&&(r=500),e=Math.min(500,Math.round(e/2)),r=Math.min(500,Math.round(r/2)),this._queue([27,112,t?1:0,255&e,255&r]),this}raw(t){return this._queue(t),this}encode(){this._flush();let t=0;this._buffer.forEach((e=>{"number"==typeof e?t++:t+=e.length}));const e=new Uint8Array(t);let r=0;return this._buffer.forEach((t=>{"number"==typeof t?(e[r]=t,r++):(e.set(t,r),r+=t.length)})),this._reset(),e}}return ci}));
